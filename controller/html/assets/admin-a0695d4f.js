import{s as Xt,u as O,d as V,r as jt,i as ke,n as Be,e as Mt,f as Yt,g as Jt,h as It,j as Bt,p as nt,k as _,w as fe,l as ae,o as h,c as m,m as e,t as E,q as Ze,v as Dt,x as xe,y as K,z as $,A as Z,T as he,B as le,C as ve,F as Y,D as We,E as ne,G as J,_ as Re,H as Te,I as De,J as Pe,K as je,L as re,a as _e,M as es,N as ts,b as ss}from"./plugin-vueexport-helper-bfb13166.js";import{u as Me,_ as Ye,a as ge,p as ns}from"./Toast-fca8bcc7.js";/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Le=typeof window<"u";function os(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const G=Object.assign;function ot(t,n){const s={};for(const l in n){const a=n[l];s[l]=me(a)?a.map(t):t(a)}return s}const qe=()=>{},me=Array.isArray,as=/\/$/,ls=t=>t.replace(as,"");function at(t,n,s="/"){let l,a={},v="",p="";const i=n.indexOf("#");let d=n.indexOf("?");return i<d&&i>=0&&(d=-1),d>-1&&(l=n.slice(0,d),v=n.slice(d+1,i>-1?i:n.length),a=t(v)),i>-1&&(l=l||n.slice(0,i),p=n.slice(i,n.length)),l=cs(l??n,s),{fullPath:l+(v&&"?")+v+p,path:l,query:a,hash:p}}function is(t,n){const s=n.query?t(n.query):"";return n.path+(s&&"?")+s+(n.hash||"")}function mt(t,n){return!n||!t.toLowerCase().startsWith(n.toLowerCase())?t:t.slice(n.length)||"/"}function rs(t,n,s){const l=n.matched.length-1,a=s.matched.length-1;return l>-1&&l===a&&Ue(n.matched[l],s.matched[a])&&Ot(n.params,s.params)&&t(n.query)===t(s.query)&&n.hash===s.hash}function Ue(t,n){return(t.aliasOf||t)===(n.aliasOf||n)}function Ot(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const s in t)if(!ds(t[s],n[s]))return!1;return!0}function ds(t,n){return me(t)?pt(t,n):me(n)?pt(n,t):t===n}function pt(t,n){return me(n)?t.length===n.length&&t.every((s,l)=>s===n[l]):t.length===1&&t[0]===n}function cs(t,n){if(t.startsWith("/"))return t;if(!t)return n;const s=n.split("/"),l=t.split("/");let a=s.length-1,v,p;for(v=0;v<l.length;v++)if(p=l[v],p!==".")if(p==="..")a>1&&a--;else break;return s.slice(0,a).join("/")+"/"+l.slice(v-(v===l.length?1:0)).join("/")}var Qe;(function(t){t.pop="pop",t.push="push"})(Qe||(Qe={}));var Fe;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Fe||(Fe={}));function us(t){if(!t)if(Le){const n=document.querySelector("base");t=n&&n.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),ls(t)}const vs=/^[^#]+#/;function hs(t,n){return t.replace(vs,"#")+n}function fs(t,n){const s=document.documentElement.getBoundingClientRect(),l=t.getBoundingClientRect();return{behavior:n.behavior,left:l.left-s.left-(n.left||0),top:l.top-s.top-(n.top||0)}}const Je=()=>({left:window.pageXOffset,top:window.pageYOffset});function ms(t){let n;if("el"in t){const s=t.el,l=typeof s=="string"&&s.startsWith("#"),a=typeof s=="string"?l?document.getElementById(s.slice(1)):document.querySelector(s):s;if(!a)return;n=fs(a,t)}else n=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(n):window.scrollTo(n.left!=null?n.left:window.pageXOffset,n.top!=null?n.top:window.pageYOffset)}function bt(t,n){return(history.state?history.state.position-n:-1)+t}const it=new Map;function ps(t,n){it.set(t,n)}function bs(t){const n=it.get(t);return it.delete(t),n}let gs=()=>location.protocol+"//"+location.host;function At(t,n){const{pathname:s,search:l,hash:a}=n,v=t.indexOf("#");if(v>-1){let i=a.includes(t.slice(v))?t.slice(v).length:1,d=a.slice(i);return d[0]!=="/"&&(d="/"+d),mt(d,"")}return mt(s,t)+l+a}function xs(t,n,s,l){let a=[],v=[],p=null;const i=({state:o})=>{const f=At(t,location),g=s.value,P=n.value;let M=0;if(o){if(s.value=f,n.value=o,p&&p===g){p=null;return}M=P?o.position-P.position:0}else l(f);a.forEach(S=>{S(s.value,g,{delta:M,type:Qe.pop,direction:M?M>0?Fe.forward:Fe.back:Fe.unknown})})};function d(){p=s.value}function u(o){a.push(o);const f=()=>{const g=a.indexOf(o);g>-1&&a.splice(g,1)};return v.push(f),f}function r(){const{history:o}=window;o.state&&o.replaceState(G({},o.state,{scroll:Je()}),"")}function c(){for(const o of v)o();v=[],window.removeEventListener("popstate",i),window.removeEventListener("beforeunload",r)}return window.addEventListener("popstate",i),window.addEventListener("beforeunload",r),{pauseListeners:d,listen:u,destroy:c}}function gt(t,n,s,l=!1,a=!1){return{back:t,current:n,forward:s,replaced:l,position:window.history.length,scroll:a?Je():null}}function _s(t){const{history:n,location:s}=window,l={value:At(t,s)},a={value:n.state};a.value||v(l.value,{back:null,current:l.value,forward:null,position:n.length-1,replaced:!0,scroll:null},!0);function v(d,u,r){const c=t.indexOf("#"),o=c>-1?(s.host&&document.querySelector("base")?t:t.slice(c))+d:gs()+t+d;try{n[r?"replaceState":"pushState"](u,"",o),a.value=u}catch(f){console.error(f),s[r?"replace":"assign"](o)}}function p(d,u){const r=G({},n.state,gt(a.value.back,d,a.value.forward,!0),u,{position:a.value.position});v(d,r,!0),l.value=d}function i(d,u){const r=G({},a.value,n.state,{forward:d,scroll:Je()});v(r.current,r,!0);const c=G({},gt(l.value,d,null),{position:r.position+1},u);v(d,c,!1),l.value=d}return{location:l,state:a,push:i,replace:p}}function ys(t){t=us(t);const n=_s(t),s=xs(t,n.state,n.location,n.replace);function l(v,p=!0){p||s.pauseListeners(),history.go(v)}const a=G({location:"",base:t,go:l,createHref:hs.bind(null,t)},n,s);return Object.defineProperty(a,"location",{enumerable:!0,get:()=>n.location.value}),Object.defineProperty(a,"state",{enumerable:!0,get:()=>n.state.value}),a}function ws(t){return t=location.host?t||location.pathname+location.search:"",t.includes("#")||(t+="#"),ys(t)}function ks(t){return typeof t=="string"||t&&typeof t=="object"}function zt(t){return typeof t=="string"||typeof t=="symbol"}const Ne={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Lt=Symbol("");var xt;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(xt||(xt={}));function He(t,n){return G(new Error,{type:t,[Lt]:!0},n)}function we(t,n){return t instanceof Error&&Lt in t&&(n==null||!!(t.type&n))}const _t="[^/]+?",$s={sensitive:!1,strict:!1,start:!0,end:!0},Ss=/[.+*?^${}()[\]/\\]/g;function Cs(t,n){const s=G({},$s,n),l=[];let a=s.start?"^":"";const v=[];for(const u of t){const r=u.length?[]:[90];s.strict&&!u.length&&(a+="/");for(let c=0;c<u.length;c++){const o=u[c];let f=40+(s.sensitive?.25:0);if(o.type===0)c||(a+="/"),a+=o.value.replace(Ss,"\\$&"),f+=40;else if(o.type===1){const{value:g,repeatable:P,optional:M,regexp:S}=o;v.push({name:g,repeatable:P,optional:M});const w=S||_t;if(w!==_t){f+=10;try{new RegExp(`(${w})`)}catch(b){throw new Error(`Invalid custom RegExp for param "${g}" (${w}): `+b.message)}}let B=P?`((?:${w})(?:/(?:${w}))*)`:`(${w})`;c||(B=M&&u.length<2?`(?:/${B})`:"/"+B),M&&(B+="?"),a+=B,f+=20,M&&(f+=-8),P&&(f+=-20),w===".*"&&(f+=-50)}r.push(f)}l.push(r)}if(s.strict&&s.end){const u=l.length-1;l[u][l[u].length-1]+=.7000000000000001}s.strict||(a+="/?"),s.end?a+="$":s.strict&&(a+="(?:/|$)");const p=new RegExp(a,s.sensitive?"":"i");function i(u){const r=u.match(p),c={};if(!r)return null;for(let o=1;o<r.length;o++){const f=r[o]||"",g=v[o-1];c[g.name]=f&&g.repeatable?f.split("/"):f}return c}function d(u){let r="",c=!1;for(const o of t){(!c||!r.endsWith("/"))&&(r+="/"),c=!1;for(const f of o)if(f.type===0)r+=f.value;else if(f.type===1){const{value:g,repeatable:P,optional:M}=f,S=g in u?u[g]:"";if(me(S)&&!P)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const w=me(S)?S.join("/"):S;if(!w)if(M)o.length<2&&(r.endsWith("/")?r=r.slice(0,-1):c=!0);else throw new Error(`Missing required param "${g}"`);r+=w}}return r||"/"}return{re:p,score:l,keys:v,parse:i,stringify:d}}function Ns(t,n){let s=0;for(;s<t.length&&s<n.length;){const l=n[s]-t[s];if(l)return l;s++}return t.length<n.length?t.length===1&&t[0]===40+40?-1:1:t.length>n.length?n.length===1&&n[0]===40+40?1:-1:0}function Es(t,n){let s=0;const l=t.score,a=n.score;for(;s<l.length&&s<a.length;){const v=Ns(l[s],a[s]);if(v)return v;s++}if(Math.abs(a.length-l.length)===1){if(yt(l))return 1;if(yt(a))return-1}return a.length-l.length}function yt(t){const n=t[t.length-1];return t.length>0&&n[n.length-1]<0}const Rs={type:0,value:""},Ps=/[a-zA-Z0-9_]/;function js(t){if(!t)return[[]];if(t==="/")return[[Rs]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function n(f){throw new Error(`ERR (${s})/"${u}": ${f}`)}let s=0,l=s;const a=[];let v;function p(){v&&a.push(v),v=[]}let i=0,d,u="",r="";function c(){u&&(s===0?v.push({type:0,value:u}):s===1||s===2||s===3?(v.length>1&&(d==="*"||d==="+")&&n(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),v.push({type:1,value:u,regexp:r,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):n("Invalid state to consume buffer"),u="")}function o(){u+=d}for(;i<t.length;){if(d=t[i++],d==="\\"&&s!==2){l=s,s=4;continue}switch(s){case 0:d==="/"?(u&&c(),p()):d===":"?(c(),s=1):o();break;case 4:o(),s=l;break;case 1:d==="("?s=2:Ps.test(d)?o():(c(),s=0,d!=="*"&&d!=="?"&&d!=="+"&&i--);break;case 2:d===")"?r[r.length-1]=="\\"?r=r.slice(0,-1)+d:s=3:r+=d;break;case 3:c(),s=0,d!=="*"&&d!=="?"&&d!=="+"&&i--,r="";break;default:n("Unknown state");break}}return s===2&&n(`Unfinished custom RegExp for param "${u}"`),c(),p(),a}function Ms(t,n,s){const l=Cs(js(t.path),s),a=G(l,{record:t,parent:n,children:[],alias:[]});return n&&!a.record.aliasOf==!n.record.aliasOf&&n.children.push(a),a}function Is(t,n){const s=[],l=new Map;n=$t({strict:!1,end:!0,sensitive:!1},n);function a(r){return l.get(r)}function v(r,c,o){const f=!o,g=Bs(r);g.aliasOf=o&&o.record;const P=$t(n,r),M=[g];if("alias"in r){const B=typeof r.alias=="string"?[r.alias]:r.alias;for(const b of B)M.push(G({},g,{components:o?o.record.components:g.components,path:b,aliasOf:o?o.record:g}))}let S,w;for(const B of M){const{path:b}=B;if(c&&b[0]!=="/"){const N=c.record.path,U=N[N.length-1]==="/"?"":"/";B.path=c.record.path+(b&&U+b)}if(S=Ms(B,c,P),o?o.alias.push(S):(w=w||S,w!==S&&w.alias.push(S),f&&r.name&&!kt(S)&&p(r.name)),g.children){const N=g.children;for(let U=0;U<N.length;U++)v(N[U],S,o&&o.children[U])}o=o||S,(S.record.components&&Object.keys(S.record.components).length||S.record.name||S.record.redirect)&&d(S)}return w?()=>{p(w)}:qe}function p(r){if(zt(r)){const c=l.get(r);c&&(l.delete(r),s.splice(s.indexOf(c),1),c.children.forEach(p),c.alias.forEach(p))}else{const c=s.indexOf(r);c>-1&&(s.splice(c,1),r.record.name&&l.delete(r.record.name),r.children.forEach(p),r.alias.forEach(p))}}function i(){return s}function d(r){let c=0;for(;c<s.length&&Es(r,s[c])>=0&&(r.record.path!==s[c].record.path||!Tt(r,s[c]));)c++;s.splice(c,0,r),r.record.name&&!kt(r)&&l.set(r.record.name,r)}function u(r,c){let o,f={},g,P;if("name"in r&&r.name){if(o=l.get(r.name),!o)throw He(1,{location:r});P=o.record.name,f=G(wt(c.params,o.keys.filter(w=>!w.optional).map(w=>w.name)),r.params&&wt(r.params,o.keys.map(w=>w.name))),g=o.stringify(f)}else if("path"in r)g=r.path,o=s.find(w=>w.re.test(g)),o&&(f=o.parse(g),P=o.record.name);else{if(o=c.name?l.get(c.name):s.find(w=>w.re.test(c.path)),!o)throw He(1,{location:r,currentLocation:c});P=o.record.name,f=G({},c.params,r.params),g=o.stringify(f)}const M=[];let S=o;for(;S;)M.unshift(S.record),S=S.parent;return{name:P,path:g,params:f,matched:M,meta:Os(M)}}return t.forEach(r=>v(r)),{addRoute:v,resolve:u,removeRoute:p,getRoutes:i,getRecordMatcher:a}}function wt(t,n){const s={};for(const l of n)l in t&&(s[l]=t[l]);return s}function Bs(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:Ds(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function Ds(t){const n={},s=t.props||!1;if("component"in t)n.default=s;else for(const l in t.components)n[l]=typeof s=="boolean"?s:s[l];return n}function kt(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function Os(t){return t.reduce((n,s)=>G(n,s.meta),{})}function $t(t,n){const s={};for(const l in t)s[l]=l in n?n[l]:t[l];return s}function Tt(t,n){return n.children.some(s=>s===t||Tt(t,s))}const Ut=/#/g,As=/&/g,zs=/\//g,Ls=/=/g,Ts=/\?/g,Ht=/\+/g,Us=/%5B/g,Hs=/%5D/g,Vt=/%5E/g,Vs=/%60/g,Gt=/%7B/g,Gs=/%7C/g,Kt=/%7D/g,Ks=/%20/g;function ct(t){return encodeURI(""+t).replace(Gs,"|").replace(Us,"[").replace(Hs,"]")}function qs(t){return ct(t).replace(Gt,"{").replace(Kt,"}").replace(Vt,"^")}function rt(t){return ct(t).replace(Ht,"%2B").replace(Ks,"+").replace(Ut,"%23").replace(As,"%26").replace(Vs,"`").replace(Gt,"{").replace(Kt,"}").replace(Vt,"^")}function Fs(t){return rt(t).replace(Ls,"%3D")}function Ws(t){return ct(t).replace(Ut,"%23").replace(Ts,"%3F")}function Qs(t){return t==null?"":Ws(t).replace(zs,"%2F")}function Xe(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function Zs(t){const n={};if(t===""||t==="?")return n;const l=(t[0]==="?"?t.slice(1):t).split("&");for(let a=0;a<l.length;++a){const v=l[a].replace(Ht," "),p=v.indexOf("="),i=Xe(p<0?v:v.slice(0,p)),d=p<0?null:Xe(v.slice(p+1));if(i in n){let u=n[i];me(u)||(u=n[i]=[u]),u.push(d)}else n[i]=d}return n}function St(t){let n="";for(let s in t){const l=t[s];if(s=Fs(s),l==null){l!==void 0&&(n+=(n.length?"&":"")+s);continue}(me(l)?l.map(v=>v&&rt(v)):[l&&rt(l)]).forEach(v=>{v!==void 0&&(n+=(n.length?"&":"")+s,v!=null&&(n+="="+v))})}return n}function Xs(t){const n={};for(const s in t){const l=t[s];l!==void 0&&(n[s]=me(l)?l.map(a=>a==null?null:""+a):l==null?l:""+l)}return n}const ut=Symbol(""),Ct=Symbol(""),et=Symbol(""),vt=Symbol(""),dt=Symbol("");function Ge(){let t=[];function n(l){return t.push(l),()=>{const a=t.indexOf(l);a>-1&&t.splice(a,1)}}function s(){t=[]}return{add:n,list:()=>t,reset:s}}function qt(t,n,s){const l=()=>{t[n].delete(s)};Mt(l),Yt(l),Jt(()=>{t[n].add(s)}),t[n].add(s)}function Ys(t){const n=ke(ut,{}).value;n&&qt(n,"leaveGuards",t)}function Js(t){const n=ke(ut,{}).value;n&&qt(n,"updateGuards",t)}function Ee(t,n,s,l,a){const v=l&&(l.enterCallbacks[a]=l.enterCallbacks[a]||[]);return()=>new Promise((p,i)=>{const d=c=>{c===!1?i(He(4,{from:s,to:n})):c instanceof Error?i(c):ks(c)?i(He(2,{from:n,to:c})):(v&&l.enterCallbacks[a]===v&&typeof c=="function"&&v.push(c),p())},u=t.call(l&&l.instances[a],n,s,d);let r=Promise.resolve(u);t.length<3&&(r=r.then(d)),r.catch(c=>i(c))})}function lt(t,n,s,l){const a=[];for(const v of t)for(const p in v.components){let i=v.components[p];if(!(n!=="beforeRouteEnter"&&!v.instances[p]))if(en(i)){const u=(i.__vccOpts||i)[n];u&&a.push(Ee(u,s,l,v,p))}else{let d=i();a.push(()=>d.then(u=>{if(!u)return Promise.reject(new Error(`Couldn't resolve component "${p}" at "${v.path}"`));const r=os(u)?u.default:u;v.components[p]=r;const o=(r.__vccOpts||r)[n];return o&&Ee(o,s,l,v,p)()}))}}return a}function en(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Nt(t){const n=ke(et),s=ke(vt),l=V(()=>n.resolve(O(t.to))),a=V(()=>{const{matched:d}=l.value,{length:u}=d,r=d[u-1],c=s.matched;if(!r||!c.length)return-1;const o=c.findIndex(Ue.bind(null,r));if(o>-1)return o;const f=Et(d[u-2]);return u>1&&Et(r)===f&&c[c.length-1].path!==f?c.findIndex(Ue.bind(null,d[u-2])):o}),v=V(()=>a.value>-1&&on(s.params,l.value.params)),p=V(()=>a.value>-1&&a.value===s.matched.length-1&&Ot(s.params,l.value.params));function i(d={}){return nn(d)?n[O(t.replace)?"replace":"push"](O(t.to)).catch(qe):Promise.resolve()}return{route:l,href:V(()=>l.value.href),isActive:v,isExactActive:p,navigate:i}}const tn=It({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Nt,setup(t,{slots:n}){const s=jt(Nt(t)),{options:l}=ke(et),a=V(()=>({[Rt(t.activeClass,l.linkActiveClass,"router-link-active")]:s.isActive,[Rt(t.exactActiveClass,l.linkExactActiveClass,"router-link-exact-active")]:s.isExactActive}));return()=>{const v=n.default&&n.default(s);return t.custom?v:Bt("a",{"aria-current":s.isExactActive?t.ariaCurrentValue:null,href:s.href,onClick:s.navigate,class:a.value},v)}}}),sn=tn;function nn(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const n=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(n))return}return t.preventDefault&&t.preventDefault(),!0}}function on(t,n){for(const s in n){const l=n[s],a=t[s];if(typeof l=="string"){if(l!==a)return!1}else if(!me(a)||a.length!==l.length||l.some((v,p)=>v!==a[p]))return!1}return!0}function Et(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Rt=(t,n,s)=>t??n??s,an=It({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:n,slots:s}){const l=ke(dt),a=V(()=>t.route||l.value),v=ke(Ct,0),p=V(()=>{let u=O(v);const{matched:r}=a.value;let c;for(;(c=r[u])&&!c.components;)u++;return u}),i=V(()=>a.value.matched[p.value]);nt(Ct,V(()=>p.value+1)),nt(ut,i),nt(dt,a);const d=_();return fe(()=>[d.value,i.value,t.name],([u,r,c],[o,f,g])=>{r&&(r.instances[c]=u,f&&f!==r&&u&&u===o&&(r.leaveGuards.size||(r.leaveGuards=f.leaveGuards),r.updateGuards.size||(r.updateGuards=f.updateGuards))),u&&r&&(!f||!Ue(r,f)||!o)&&(r.enterCallbacks[c]||[]).forEach(P=>P(u))},{flush:"post"}),()=>{const u=a.value,r=t.name,c=i.value,o=c&&c.components[r];if(!o)return Pt(s.default,{Component:o,route:u});const f=c.props[r],g=f?f===!0?u.params:typeof f=="function"?f(u):f:null,M=Bt(o,G({},g,n,{onVnodeUnmounted:S=>{S.component.isUnmounted&&(c.instances[r]=null)},ref:d}));return Pt(s.default,{Component:M,route:u})||M}}});function Pt(t,n){if(!t)return null;const s=t(n);return s.length===1?s[0]:s}const ln=an;function rn(t){const n=Is(t.routes,t),s=t.parseQuery||Zs,l=t.stringifyQuery||St,a=t.history,v=Ge(),p=Ge(),i=Ge(),d=Xt(Ne);let u=Ne;Le&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const r=ot.bind(null,x=>""+x),c=ot.bind(null,Qs),o=ot.bind(null,Xe);function f(x,j){let R,D;return zt(x)?(R=n.getRecordMatcher(x),D=j):D=x,n.addRoute(D,R)}function g(x){const j=n.getRecordMatcher(x);j&&n.removeRoute(j)}function P(){return n.getRoutes().map(x=>x.record)}function M(x){return!!n.getRecordMatcher(x)}function S(x,j){if(j=G({},j||d.value),typeof x=="string"){const L=at(s,x,j.path),se=n.resolve({path:L.path},j),Ve=a.createHref(L.fullPath);return G(L,se,{params:o(se.params),hash:Xe(L.hash),redirectedFrom:void 0,href:Ve})}let R;if("path"in x)R=G({},x,{path:at(s,x.path,j.path).path});else{const L=G({},x.params);for(const se in L)L[se]==null&&delete L[se];R=G({},x,{params:c(x.params)}),j.params=c(j.params)}const D=n.resolve(R,j),Q=x.hash||"";D.params=r(o(D.params));const te=is(l,G({},x,{hash:qs(Q),path:D.path})),T=a.createHref(te);return G({fullPath:te,hash:Q,query:l===St?Xs(x.query):x.query||{}},D,{redirectedFrom:void 0,href:T})}function w(x){return typeof x=="string"?at(s,x,d.value.path):G({},x)}function B(x,j){if(u!==x)return He(8,{from:j,to:x})}function b(x){return X(x)}function N(x){return b(G(w(x),{replace:!0}))}function U(x){const j=x.matched[x.matched.length-1];if(j&&j.redirect){const{redirect:R}=j;let D=typeof R=="function"?R(x):R;return typeof D=="string"&&(D=D.includes("?")||D.includes("#")?D=w(D):{path:D},D.params={}),G({query:x.query,hash:x.hash,params:"path"in D?{}:x.params},D)}}function X(x,j){const R=u=S(x),D=d.value,Q=x.state,te=x.force,T=x.replace===!0,L=U(R);if(L)return X(G(w(L),{state:typeof L=="object"?G({},Q,L.state):Q,force:te,replace:T}),j||R);const se=R;se.redirectedFrom=j;let Ve;return!te&&rs(l,D,R)&&(Ve=He(16,{to:se,from:D}),k(D,D,!0,!1)),(Ve?Promise.resolve(Ve):$e(se,D)).catch(ie=>we(ie)?we(ie,2)?ie:C(ie):I(ie,se,D)).then(ie=>{if(ie){if(we(ie,2))return X(G({replace:T},w(ie.to),{state:typeof ie.to=="object"?G({},Q,ie.to.state):Q,force:te}),j||se)}else ie=be(se,D,!0,T,Q);return Se(se,D,ie),ie})}function pe(x,j){const R=B(x,j);return R?Promise.reject(R):Promise.resolve()}function $e(x,j){let R;const[D,Q,te]=dn(x,j);R=lt(D.reverse(),"beforeRouteLeave",x,j);for(const L of D)L.leaveGuards.forEach(se=>{R.push(Ee(se,x,j))});const T=pe.bind(null,x,j);return R.push(T),ze(R).then(()=>{R=[];for(const L of v.list())R.push(Ee(L,x,j));return R.push(T),ze(R)}).then(()=>{R=lt(Q,"beforeRouteUpdate",x,j);for(const L of Q)L.updateGuards.forEach(se=>{R.push(Ee(se,x,j))});return R.push(T),ze(R)}).then(()=>{R=[];for(const L of x.matched)if(L.beforeEnter&&!j.matched.includes(L))if(me(L.beforeEnter))for(const se of L.beforeEnter)R.push(Ee(se,x,j));else R.push(Ee(L.beforeEnter,x,j));return R.push(T),ze(R)}).then(()=>(x.matched.forEach(L=>L.enterCallbacks={}),R=lt(te,"beforeRouteEnter",x,j),R.push(T),ze(R))).then(()=>{R=[];for(const L of p.list())R.push(Ee(L,x,j));return R.push(T),ze(R)}).catch(L=>we(L,8)?L:Promise.reject(L))}function Se(x,j,R){for(const D of i.list())D(x,j,R)}function be(x,j,R,D,Q){const te=B(x,j);if(te)return te;const T=j===Ne,L=Le?history.state:{};R&&(D||T?a.replace(x.fullPath,G({scroll:T&&L&&L.scroll},Q)):a.push(x.fullPath,Q)),d.value=x,k(x,j,R,T),C()}let ce;function ye(){ce||(ce=a.listen((x,j,R)=>{if(!Ce.listening)return;const D=S(x),Q=U(D);if(Q){X(G(Q,{replace:!0}),D).catch(qe);return}u=D;const te=d.value;Le&&ps(bt(te.fullPath,R.delta),Je()),$e(D,te).catch(T=>we(T,12)?T:we(T,2)?(X(T.to,D).then(L=>{we(L,20)&&!R.delta&&R.type===Qe.pop&&a.go(-1,!1)}).catch(qe),Promise.reject()):(R.delta&&a.go(-R.delta,!1),I(T,D,te))).then(T=>{T=T||be(D,te,!1),T&&(R.delta&&!we(T,8)?a.go(-R.delta,!1):R.type===Qe.pop&&we(T,20)&&a.go(-1,!1)),Se(D,te,T)}).catch(qe)}))}let A=Ge(),H=Ge(),F;function I(x,j,R){C(x);const D=H.list();return D.length?D.forEach(Q=>Q(x,j,R)):console.error(x),Promise.reject(x)}function y(){return F&&d.value!==Ne?Promise.resolve():new Promise((x,j)=>{A.add([x,j])})}function C(x){return F||(F=!x,ye(),A.list().forEach(([j,R])=>x?R(x):j()),A.reset()),x}function k(x,j,R,D){const{scrollBehavior:Q}=t;if(!Le||!Q)return Promise.resolve();const te=!R&&bs(bt(x.fullPath,0))||(D||!R)&&history.state&&history.state.scroll||null;return Be().then(()=>Q(x,j,te)).then(T=>T&&ms(T)).catch(T=>I(T,x,j))}const W=x=>a.go(x);let q;const ue=new Set,Ce={currentRoute:d,listening:!0,addRoute:f,removeRoute:g,hasRoute:M,getRoutes:P,resolve:S,options:t,push:b,replace:N,go:W,back:()=>W(-1),forward:()=>W(1),beforeEach:v.add,beforeResolve:p.add,afterEach:i.add,onError:H.add,isReady:y,install(x){const j=this;x.component("RouterLink",sn),x.component("RouterView",ln),x.config.globalProperties.$router=j,Object.defineProperty(x.config.globalProperties,"$route",{enumerable:!0,get:()=>O(d)}),Le&&!q&&d.value===Ne&&(q=!0,b(a.location).catch(Q=>{}));const R={};for(const Q in Ne)R[Q]=V(()=>d.value[Q]);x.provide(et,j),x.provide(vt,jt(R)),x.provide(dt,d);const D=x.unmount;ue.add(x),x.unmount=function(){ue.delete(x),ue.size<1&&(u=Ne,ce&&ce(),ce=null,d.value=Ne,q=!1,F=!1),D()}}};return Ce}function ze(t){return t.reduce((n,s)=>n.then(()=>s()),Promise.resolve())}function dn(t,n){const s=[],l=[],a=[],v=Math.max(n.matched.length,t.matched.length);for(let p=0;p<v;p++){const i=n.matched[p];i&&(t.matched.find(u=>Ue(u,i))?l.push(i):s.push(i));const d=t.matched[p];d&&(n.matched.find(u=>Ue(u,d))||a.push(d))}return[s,l,a]}function ht(){return ke(et)}function ft(){return ke(vt)}const cn="/img/logo.svg",un={class:"dropdown bg-white rounded-md py-1 z-20",style:{outline:"none","--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","pointer-events":"auto"}},vn={class:"block px-4 py-2"},hn={class:"opacity-75"},fn=e("div",{class:"my-1 border-b border-base-300"},null,-1),mn=e("div",{class:"relative block px-4 py-2 cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100"},[e("a",{class:"stretched-link",href:"/admin/logout"},"登出")],-1),pn={__name:"UserMenu",props:{userName:String,userAccount:String,toleft:Number,totop:Number},emits:["close"],setup(t,{emit:n}){const s=t;Me();const l=_(null),a=V(()=>{var i;return String(String(s.toleft+32-((i=l.value)==null?void 0:i.clientWidth)))}),v=V(()=>String(s.totop+40)),p=i=>{n("close")};return(i,d)=>{const u=Dt("click-away");return ae((h(),m("div",{ref_key:"userMenu",ref:l,class:"shadow-lg border border-base-300 rounded-md z-20",style:Ze("position: fixed; left: "+O(a)+"px; top: "+O(v)+"px; min-width: max-content; --radix-popper-transform-origin: 100% 0px;")},[e("div",un,[e("div",vn,[e("div",null,[e("strong",null,E(t.userName),1)]),e("div",hn,E(t.userAccount),1)]),fn,mn])],4)),[[u,p]])}}};const bn={key:0,class:"bg-amber-700 text-white font-medium py-2 px-4 text-center"},gn=["href"],xn={class:"bg-base-200 border-b border-base-300 pt-4 mb-6"},_n={class:"container mx-auto mb-4 md:mb-6"},yn={class:"flex justify-between items-center px-2 md:px-0"},wn={href:"/",class:"flex items-center",style:{"max-width":"80%"}},kn=e("img",{width:"18",height:"18",src:cn},null,-1),$n={role:"banner",class:"text-lg font-semibold ml-3 truncate"},Sn=e("span",{class:"badge badge-secondary"},"仅供测试",-1),Cn={class:"flex items-center"},Nn=e("a",{class:"hidden text-gray-600 hover:text-gray-800 sm:inline-block px-2 py-1",href:"https://github.com/gps949/tailscale/releases",target:"_blank",rel:"noopener noreferrer"},"下载客户端",-1),En={class:"relative rounded-full"},Rn={class:"relative shrink-0 rounded-full overflow-hidden w-8 h-8"},Pn={class:"flex items-center justify-center text-center capitalize text-white font-medium pointer-events-none w-8 h-8",style:{"background-color":"rgb(161, 56, 33)"}},jn={class:"relative overflow-hidden",style:{top:"1px"}},Mn={id:"nav",class:"navigation flex items-center overflow-auto left-1 relative md:container md:mx-auto md:px-0 md:-left-3"},In=["stroke-width"],Bn=e("rect",{x:"2",y:"2",width:"20",height:"8",rx:"2",ry:"2"},null,-1),Dn=e("rect",{x:"2",y:"14",width:"20",height:"8",rx:"2",ry:"2"},null,-1),On=e("line",{x1:"6",y1:"6",x2:"6.01",y2:"6"},null,-1),An=e("line",{x1:"6",y1:"18",x2:"6.01",y2:"18"},null,-1),zn=[Bn,Dn,On,An],Ln=["stroke-width"],Tn=e("circle",{cx:"12",cy:"12",r:"10"},null,-1),Un=e("line",{x1:"2",y1:"12",x2:"22",y2:"12"},null,-1),Hn=e("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"},null,-1),Vn=[Tn,Un,Hn],Gn=["stroke-width"],Kn=e("circle",{cx:"12",cy:"12",r:"3"},null,-1),qn=e("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},null,-1),Fn=[Kn,qn],Wn={key:2,class:"container mx-auto pb-20 md:pb-24"},Qn={class:"mb-24"},Zn={class:"w-full p-3 flex items-center justify-center text-sm"},Xn={class:"flex items-center justify-center"},Yn=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"mr-3 text-red-400 h-5 w-5"},[e("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),e("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),e("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})],-1),Jn=e("strong",null,"错误：",-1),eo={__name:"Console",setup(t){ht();const n=ft(),s=_(null),l=_(0),a=_(0),v=_(!1),p=_(""),i=V(()=>n.path);function d(){var w,B;l.value=(w=s.value)==null?void 0:w.getBoundingClientRect().left,a.value=(B=s.value)==null?void 0:B.getBoundingClientRect().top}const u=_(!1);function r(){u.value=!u.value,u.value?document.body.style.pointerEvents="none":document.body.style.removeProperty("pointer-events")}const c=V(()=>{let w=n.path;if(w=="/")return"machine";if(w.substring(0,4)=="/dns")return"dns";if(w.substring(0,8)=="/machine")return"machine";if(w.substring(0,8)=="/setting")return"setting"}),o=_(""),f=_(""),g=_(""),P=_(""),M=_("");function S(){return new Promise((w,B)=>{axios.get("/admin/api/self").then(function(b){(b.data.errormsg==null||b.data.errormsg==="")&&(o.value=b.data.useraccount,f.value=b.data.basedomain,g.value=b.data.username,P.value=b.data.usernamehead,M.value=b.data.orgname,w("success")),B("err")}).catch(function(b){B("error")})})}return xe(()=>{d(),window.addEventListener("resize",d),window.addEventListener("scroll",d),axios.interceptors.response.use(w=>(w.status==200?(p.value="",v.value=!1):(p.value="登录状态超时失效",v.value=!0),w),w=>{if(w&&w.response)switch(w.response.status){case 400:w.message="请求错误(400)";break;case 401:w.message="未授权，请重新登录(401)";break;case 403:w.message="拒绝访问(403)";break;case 404:w.message="请求出错(404)";break;case 408:w.message="请求超时(408)";break;case 500:w.message="服务器错误(500)";break;case 501:w.message="服务未实现(501)";break;case 502:w.message="网络错误(502)";break;case 503:w.message="服务不可用(503)";break;case 504:w.message="网络超时(504)";break;case 505:w.message="HTTP版本不受支持(505)";break;default:w.message="连接出错"+w.response.status}else w.message="连接服务器失败!";return p.value=w.message,v.value=!0,Promise.reject(w)}),S().then().catch(),setInterval(()=>{S().then().catch()},15e3)}),(w,B)=>{const b=We("router-link"),N=We("router-view");return h(),m(Y,null,[v.value?(h(),m("div",bn,[K("连接服务器出现"+E(p.value)+"，请尝试 ",1),e("a",{class:"text-amber-100",href:"/login?next_url=/admin#"+O(i)},"重新登录",8,gn)])):$("",!0),e("div",xn,[e("div",_n,[e("header",yn,[e("a",wn,[kn,e("div",$n,E(M.value),1),Sn]),e("nav",Cn,[Nn,e("div",{ref_key:"userAvatar",ref:s,onClick:r,class:"heart-wrapper ml-2"},[e("button",En,[e("div",Rn,[e("div",Pn,E(P.value),1)])])],512),(h(),Z(he,{to:"body"},[u.value?(h(),Z(pn,{key:0,toleft:l.value,totop:a.value,"user-account":o.value,"user-name":g.value,onClose:r},null,8,["toleft","totop","user-account","user-name"])):$("",!0)]))])])]),e("div",jn,[e("nav",Mn,[le(b,{class:"whitespace-nowrap py-2 group relative",to:"/machines"},{default:ve(()=>[e("div",{class:ne([{"text-blue-600 after:visible":O(c)=="machine","text-gray-600 group-hover:text-gray-800 after:invisible":O(c)!="machine"},"px-3 py-2 flex items-center rounded-md group-hover:bg-gray-200 after:absolute after:bottom-0 after:right-3 after:left-3 after:h-0.5 after:bg-blue-600"])},[(h(),m("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.125em",height:"1.125em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":O(c)=="machine"?"2.5":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"mr-2 inline-block"},zn,8,In)),e("div",{class:ne({"font-medium":O(c)=="machine"})},"设备",2)],2)]),_:1}),le(b,{class:"whitespace-nowrap py-2 group relative",to:"/dns"},{default:ve(()=>[e("div",{class:ne([{"text-blue-600 after:visible":O(c)=="dns","text-gray-600 group-hover:text-gray-800 after:invisible":O(c)!="dns"},"px-3 py-2 flex items-center rounded-md group-hover:bg-gray-200 after:absolute after:bottom-0 after:right-3 after:left-3 after:h-0.5 after:bg-blue-600"])},[(h(),m("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.125em",height:"1.125em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":O(c)=="dns"?"2.5":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"mr-2 inline-block"},Vn,8,Ln)),e("div",{class:ne({"font-medium":O(c)=="dns"})},"DNS",2)],2)]),_:1}),le(b,{class:"whitespace-nowrap py-2 group relative",to:"/settings"},{default:ve(()=>[e("div",{class:ne([{"text-blue-600 after:visible":O(c)=="setting","text-gray-600 group-hover:text-gray-800 after:invisible":O(c)!="setting"},"px-3 py-2 flex items-center rounded-md group-hover:bg-gray-200 after:absolute after:bottom-0 after:right-3 after:left-3 after:h-0.5 after:bg-blue-600"])},[(h(),m("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.125em",height:"1.125em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":O(c)=="setting"?"2.5":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"mr-2 inline-block"},Fn,8,Gn)),e("div",{class:ne({"font-medium":O(c)=="setting"})},"设置",2)],2)]),_:1})])])]),v.value?$("",!0):(h(),Z(N,{key:1})),v.value?(h(),m("main",Wn,[e("section",Qn,[e("div",Zn,[e("div",Xn,[Yn,e("div",null,[Jn,K(" 请求失败 "+E(p.value),1)])])])])])):$("",!0)],64)}}},to={class:"dropdown bg-white rounded-md py-1 z-20",style:{outline:"none","--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","pointer-events":"auto"}},so=e("div",{class:"block px-4 py-2 cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100"}," 分享…",-1),no=e("div",{class:"my-1 border-b border-base-300"},null,-1),oo=e("div",{class:"block px-4 py-2 cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100"}," 编辑ACL标签…",-1),ao=e("div",{class:"my-1 border-b border-base-300"},null,-1),Ft={__name:"MachineMenu",props:{toleft:Number,totop:Number,neverExpires:Boolean},emits:["close"],setup(t,{emit:n}){const s=t;Me();const l=_(null),a=V(()=>{var i;return String(String(s.toleft+32-((i=l.value)==null?void 0:i.clientWidth)))}),v=V(()=>{var i;return s.totop<=window.innerHeight/2?String(s.totop+36):String(s.totop-10-((i=l.value)==null?void 0:i.clientHeight))}),p=i=>{n("close")};return(i,d)=>{const u=Dt("click-away");return ae((h(),m("div",{ref_key:"machineMenu",ref:l,class:"shadow-xl border border-base-300 rounded-md z-20",style:Ze("position: fixed; left: "+O(a)+"px; top: "+O(v)+"px; min-width: max-content; --radix-popper-transform-origin: 0% 0px;")},[e("div",to,[e("div",{onClick:d[0]||(d[0]=r=>i.$emit("showdialog-updatehostname")),class:"block px-4 py-2 cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100"}," 编辑设备名称…"),so,e("div",{onClick:d[1]||(d[1]=r=>i.$emit("set-expires")),class:"block px-4 py-2 cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100"},E(t.neverExpires?"启用密钥过期":"禁用密钥过期"),1),no,e("div",{onClick:d[2]||(d[2]=r=>i.$emit("showdialog-setsubnet")),class:"block px-4 py-2 cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100"}," 编辑子网转发…"),oo,ao,e("div",{onClick:d[3]||(d[3]=r=>i.$emit("showdialog-remove")),class:"block px-4 py-2 cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100 text-red-400"}," 移除…")])],4)),[[u,p]])}}},lo={class:"bg-white rounded-lg relative p-4 md:p-6 text-gray-700 max-w-lg min-w-[19rem] my-8 mx-auto w-[97%] shadow-2xl",style:{"pointer-events":"auto"}},io={class:"flex items-center justify-between space-x-4 mb-5 mr-8"},ro={class:"font-semibold text-lg truncate"},co=e("p",{class:"text-gray-700 mb-4"},"这个设备将从您的蜃境网络中永久删除！如需重新添加该设备，您将需要在该设备上重新进行授权",-1),uo={class:"flex mt-10 justify-end space-x-4"},vo=e("button",{class:"btn border-0 bg-red-600 hover:bg-red-700 text-white h-9 min-h-fit",type:"submit"},"删除设备",-1),ho=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.25em",height:"1.25em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1),fo=[ho],Wt={__name:"RemoveMachine",props:{machineName:String},setup(t){return Me(),(n,s)=>(h(),m("div",{onClick:s[3]||(s[3]=J(l=>n.$emit("close"),["self"])),class:"fixed overflow-y-auto inset-0 py-8 z-30 bg-gray-900 bg-opacity-[0.07]",style:{"pointer-events":"auto"}},[e("div",lo,[e("header",io,[e("div",ro,"删除 "+E(t.machineName),1)]),e("form",{onSubmit:s[1]||(s[1]=J(l=>n.$emit("confirm"),["prevent"]))},[co,e("footer",uo,[e("button",{onClick:s[0]||(s[0]=l=>n.$emit("close")),class:"btn border border-base-300 hover:border-base-300 bg-base-200 hover:bg-base-300 text-black h-9 min-h-fit",type:"button"},"取消"),vo])],32),e("button",{onClick:s[2]||(s[2]=l=>n.$emit("close")),class:"btn btn-sm btn-ghost absolute top-5 right-5 px-2 py-2 border-0 bg-base-0 focus:bg-base-200 hover:bg-base-200",type:"button"},fo)])]))}};const tt=t=>(Pe("data-v-7e611cdc"),t=t(),je(),t),mo={class:"bg-white rounded-lg relative p-4 md:p-6 text-gray-700 max-w-lg min-w-[19rem] my-8 mx-auto w-[97%] shadow-2xl",style:{"pointer-events":"auto"}},po={class:"flex items-center justify-between space-x-4 mb-5 mr-8"},bo={class:"font-semibold text-lg truncate"},go=tt(()=>e("p",{class:"text-gray-700 mb-6"},[K("这个名称显示在控制台、客户端，以及生成对应的「"),e("strong",null,"幻域"),K("」名称")],-1)),xo={class:"flex items-center"},_o=["disabled"],yo=tt(()=>e("label",{for:"auto-generate-checkbox",class:"font-medium ml-3"},"由设备OS主机名生成",-1)),wo=tt(()=>e("label",{for:"machine-name",class:"block font-medium mt-6 mb-2"},"设备名称",-1)),ko={class:"flex mb-2"},$o={class:"relative w-full z-30"},So=["disabled"],Co={key:0,class:"text-sm text-red-500 mb-2"},No={key:1,class:"text-sm text-red-500 mb-2"},Eo={key:2,class:"text-sm text-red-500 mb-2"},Ro={key:3,class:"text-sm text-gray-600"},Po={class:"text-xs break-words bg-gray-200 px-1 rounded"},jo={key:4,class:"text-sm text-gray-600"},Mo={class:"text-xs break-words bg-gray-200 px-1 rounded"},Io={class:"text-xs break-words bg-gray-200 px-1 rounded"},Bo={class:"flex mt-10 justify-end space-x-4"},Do=["disabled"],Oo=["disabled"],Ao=tt(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.25em",height:"1.25em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)),zo=[Ao],Lo={__name:"UpdateHostname",props:{id:String,hostName:String,givenName:String,autoGen:Boolean},emits:["update-done","update-fail","close"],setup(t,{emit:n}){const s=t;Me();const l=_(!1),a=_(!0),v=_(""),p=_(!1),i=_(!1),d=_(""),u=_(!1),r=_(!1),c=_(!1);fe(()=>a.value,f=>{u.value=!1,r.value=!1,c.value=!1,f==s.autoGen?p.value=!1:p.value=!0,f&&(s.autoGen?v.value=s.givenName:v.value=s.hostName)}),fe(()=>v.value,f=>{u.value=!1,r.value=!1,c.value=!1,v.value=v.value.toLowerCase().replace(/[^-0-9a-z]/ig,"-").replace(/--*/g,"-"),f==s.givenName?i.value=!1:i.value=!0}),xe(()=>{p.value=!1,i.value=!1,a.value=s.autoGen,v.value=s.givenName,u.value=!1,r.value=!1,c.value=!1});function o(){if(!/^([0-9a-z]|-(?!-))+$/.test(v.value)){c.value=!0;return}if(/^(-.*|.*-)$/.test(v.value)){c.value=!0;return}l.value=!0;var f="";d.value=s.hostName,a.value||(f=v.value,d.value=v.value),axios.post("/admin/api/machines",{mid:s.id,state:"rename-node",nodeName:f}).then(function(g){g.data.status=="success"?g.data.data.name==d.value?n("update-done",g.data.data.name,g.data.data.automaticNameMode,!0):f===""?(u.value=!0,n("update-done",g.data.data.name,g.data.data.automaticNameMode,!1)):g.data.data.name==s.givenName?(r.value=!0,n("update-fail","目标主机名已存在！")):(console.log("unexpected case happended during the hostname updating!"),n("update-fail","意外情形发生了！")):n("update-fail",g.data.status.substring(6))}).catch(function(g){console.log(g),n("update-fail",g)}),l.value=!1}return(f,g)=>(h(),m("div",{onClick:g[5]||(g[5]=J(P=>f.$emit("close"),["self"])),class:"fixed overflow-y-auto inset-0 py-8 z-30 bg-gray-900 bg-opacity-[0.07]",style:{"pointer-events":"auto"}},[e("div",mo,[e("header",po,[e("div",bo,"修改设备名称 "+E(t.givenName),1)]),e("form",{onSubmit:g[3]||(g[3]=J(P=>f.$emit("confirm"),["prevent"]))},[go,e("div",xo,[ae(e("input",{disabled:l.value,"onUpdate:modelValue":g[0]||(g[0]=P=>a.value=P),id:"auto-generate-checkbox",type:"checkbox",class:"toggle toggle-sm"},null,8,_o),[[Te,a.value]]),yo]),wo,e("div",ko,[e("div",$o,[ae(e("input",{"onUpdate:modelValue":g[1]||(g[1]=P=>v.value=P),class:"input w-full z-30 border focus:outline-blue-500/60 hover:border disabled:hover:border-stone-200 disabled:border-stone-200 border-stone-200 hover:border-stone-400 rounded-md h-9 min-h-fit",type:"text",disabled:l.value||a.value,id:"machine-name"},null,8,So),[[De,v.value]])])]),u.value?(h(),m("p",Co,"名称 “"+E(d.value)+"” 已有设备占用 , 因此设备被自动命名为 “"+E(v.value)+"”.",1)):$("",!0),r.value?(h(),m("p",No,"名称 “"+E(d.value)+"” 已有设备占用",1)):$("",!0),c.value?(h(),m("p",Eo,"名称不能为空，只能是字母数字和连接线组成，且不能以连接线开头结尾")):$("",!0),i.value?$("",!0):(h(),m("div",Ro,[K("这个设备可以通过「幻域」使用 "),e("code",Po,E(t.givenName),1),K(" 进行访问")])),i.value?(h(),m("div",jo,[K("这个设备可以通过「幻域」使用 "),e("code",Mo,E(v.value),1),K(" 进行访问。 "),e("code",Io,E(t.givenName),1),K(" 不再指向该设备。")])):$("",!0),e("footer",Bo,[e("button",{disabled:l.value,onClick:g[2]||(g[2]=P=>f.$emit("close")),class:"btn border border-base-300 hover:border-base-300 bg-base-200 hover:bg-base-300 text-black h-9 min-h-fit",type:"button"},"取消",8,Do),e("button",{disabled:l.value||!p.value&&!i.value,onClick:o,class:"btn border-0 bg-blue-500 hover:bg-blue-900 disabled:bg-blue-500/60 text-white disabled:text-white/60 h-9 min-h-fit",type:"submit"},"更新",8,Oo)])],32),e("button",{onClick:g[4]||(g[4]=P=>f.$emit("close")),class:"btn btn-sm btn-ghost absolute top-5 right-5 px-2 py-2 border-0 bg-base-0 focus:bg-base-200 hover:bg-base-200",type:"button"},zo)])]))}},Qt=Re(Lo,[["__scopeId","data-v-7e611cdc"]]);const Ie=t=>(Pe("data-v-a389bf8d"),t=t(),je(),t),To={class:"bg-white rounded-lg relative p-4 md:p-6 text-gray-700 max-w-lg min-w-[19rem] my-8 mx-auto w-[97%] shadow-2xl",style:{"pointer-events":"auto"}},Uo={class:"flex items-center justify-between space-x-4 mb-5 mr-8"},Ho={class:"font-semibold text-lg truncate"},Vo={class:"mb-6"},Go=Ie(()=>e("h3",{class:"font-semibold text-gray-800 mb-2"},"子网转发路由",-1)),Ko=Ie(()=>e("p",{class:"text-gray-700 mb-3"},"通过子网转发连接您无法安装蜃境客户端的设备",-1)),qo={key:0,class:"rounded-md border bg-stone-100 border-stone-300 p-6"},Fo=Ie(()=>e("div",{class:"flex justify-center"},[e("div",{class:"w-full text-center max-w-xl text-gray-500"}," 该设备未披露任何子网转发路由")],-1)),Wo=[Fo],Qo={key:1},Zo={class:"flex items-center py-2 border-t"},Xo=["disabled","checked","id"],Yo={class:"flex items-center"},Jo=["for"],ea={key:2,class:"flex-1 flex border-t items-center pt-2"},ta=["disabled"],sa=["disabled"],na=Ie(()=>e("h3",{class:"font-semibold flex items-center text-gray-800 mb-2"},"出口节点",-1)),oa=Ie(()=>e("p",{class:"text-gray-700 mb-3"},"允许您的网络上访问互联网流量通过该设备流出",-1)),aa={class:"flex items-center"},la=["disabled","checked"],ia=Ie(()=>e("label",{for:"exit-node"},"用作出口节点",-1)),ra={key:0,class:"tooltip","data-tip":"该设备未声明它自己为出口节点。可使用 --advertise-exit-node 参数再次运行以开启。"},da=Ie(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"mx-2 text-gray-500"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})],-1)),ca=[da],ua=Ie(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.25em",height:"1.25em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)),va=[ua],ha={__name:"SetSubnet",props:{id:String,currentMachine:Object},emits:["update-done","update-fail"],setup(t,{emit:n}){const s=t;Me();const l=_(!1),a=V(()=>s.currentMachine.allowedIPs&&s.currentMachine.allowedIPs.length>0),v=V(()=>s.currentMachine.extraIPs&&s.currentMachine.extraIPs.length>0);function p(d){if(!s.currentMachine.allowedIPs||s.currentMachine.allowedIPs.length==0)return!1;for(var u in s.currentMachine.allowedIPs)if(d===s.currentMachine.allowedIPs[u])return!0;return!1}xe(()=>{});function i(d){l.value=!0;var u=[];if(d!="Off")for(var r in s.currentMachine.advertisedIPs)(d=="On"||document.getElementById(s.currentMachine.advertisedIPs[r]).checked)&&u.push(s.currentMachine.advertisedIPs[r]);var c=document.getElementById("exit-node").checked;axios.post("/admin/api/machines",{mid:s.id,state:"set-route-settings",allowedIPs:u,allowedExitNode:c}).then(function(o){o.data.status=="success"?n("update-done",o.data.data.advertisedIPs,o.data.data.allowedIPs,o.data.data.extraIPs,o.data.data.allowedExitNode):n("update-fail",o.data.status.substring(6))}).catch(function(o){console.log(o),n("update-fail",o)}),l.value=!1}return(d,u)=>(h(),m("div",{onClick:u[5]||(u[5]=J(r=>d.$emit("close"),["self"])),class:"fixed overflow-y-auto inset-0 py-8 z-30 bg-gray-900 bg-opacity-[0.07]",style:{"pointer-events":"auto"}},[e("div",To,[e("header",Uo,[e("div",Ho,"编辑 "+E(t.currentMachine.name)+" 子网转发设置",1)]),e("div",Vo,[Go,Ko,e("div",null,[t.currentMachine.hasSubnets?$("",!0):(h(),m("div",qo,Wo)),t.currentMachine.hasSubnets?(h(),m("div",Qo,[(h(!0),m(Y,null,re(t.currentMachine.advertisedIPs,r=>(h(),m("li",Zo,[e("div",null,[e("input",{onChange:u[0]||(u[0]=c=>i("Update")),disabled:l.value,checked:p(r),id:r,type:"checkbox",class:"toggle block mr-3"},null,40,Xo)]),e("div",Yo,[e("label",{for:r},E(r),9,Jo)])]))),256))])):$("",!0),t.currentMachine.hasSubnets?(h(),m("div",ea,[e("button",{onClick:u[1]||(u[1]=r=>i("Off")),class:"btn border-0 bg-red-600 hover:bg-red-700 disabled:bg-red-600/60 disabled:text-white/60 text-white h-9 min-h-fit mr-2",disabled:!O(a)},"全部禁用",8,ta),e("button",{onClick:u[2]||(u[2]=r=>i("On")),class:"btn border border-stone-300 hover:border-stone-300 disabled:border-stone-300 bg-base-200 hover:bg-base-300 disabled:bg-base-200/60 text-black disabled:text-black/30 h-9 min-h-fit",disabled:!O(v)},"全部启用",8,sa)])):$("",!0)])]),e("div",null,[na,oa,e("div",aa,[e("input",{onChange:u[3]||(u[3]=r=>i("Update")),disabled:l.value||!t.currentMachine.advertisedExitNode,checked:t.currentMachine.allowedExitNode,id:"exit-node",type:"checkbox",class:"toggle mr-3"},null,40,la),ia,t.currentMachine.advertisedExitNode?$("",!0):(h(),m("span",ra,ca))])]),e("button",{onClick:u[4]||(u[4]=r=>d.$emit("close")),class:"btn btn-sm btn-ghost absolute top-5 right-5 px-2 py-2 border-0 bg-base-0 focus:bg-base-200 hover:bg-base-200",type:"button"},va)])]))}},Zt=Re(ha,[["__scopeId","data-v-a389bf8d"]]);const de=t=>(Pe("data-v-f9316f52"),t=t(),je(),t),fa={class:"container mx-auto pb-20 md:pb-24"},ma={class:"mb-24"},pa=de(()=>e("header",{class:"mb-8"},[e("div",{class:"flex justify-between items-center"},[e("div",{class:"flex items-center"},[e("h1",{class:"text-3xl font-semibold tracking-tight leading-tight mb-2",tabindex:"-1"}," 设备 ")])])],-1)),ba={class:"inline-flex items-center align-middle justify-center font-medium border border-gray-200 bg-gray-200 text-gray-600 rounded-full px-2 py-1 leading-none text-sm mb-8"},ga={class:"table w-full"},xa=de(()=>e("thead",null,[e("tr",null,[e("th",{class:"md:w-1/4 flex-auto md:flex-initial md:shrink-0 w-0 text-ellipsis"}," 设备 "),e("th",{class:"hidden md:table-cell md:w-1/4"},"IP"),e("th",{class:"hidden md:table-cell w-1/4 lg:w-1/5"},"系统"),e("th",{class:"hidden lg:table-cell md:flex-auto"},"状态"),e("th",{class:"table-cell justify-end ml-auto md:ml-0 relative w-1/6 lg:w-12"},[e("span",{class:"sr-only"},"设备操作菜单")])])],-1)),_a=["id","v-if","onMouseenter","onMouseleave"],ya={class:"md:w-1/4 flex-auto md:flex-initial md:shrink-0 w-0 text-ellipsis"},wa={class:"items-center text-gray-900"},ka={class:"font-semibold hover:text-blue-500"},$a={class:"stretched-link"},Sa={class:"md:hidden flex space-x-1 truncate"},Ca={class:"text-sm"},Na=de(()=>e("span",null,"·",-1)),Ea={class:"md:hidden text-gray-600 text-sm",title:"m.ipnVersion"},Ra={class:"flex items-center text-gray-600 text-sm"},Pa={class:"my-1"},ja={key:0},Ma=de(()=>e("div",{class:"inline-flex items-center align-middle justify-center font-medium border border-orange-50 bg-orange-50 text-orange-600 rounded-sm px-1 text-xs mr-1"}," 外部共享 ",-1)),Ia=[Ma],Ba={key:1},Da=de(()=>e("div",{class:"inline-flex items-center align-middle justify-center font-medium border border-orange-50 bg-orange-50 text-orange-600 rounded-sm px-1 text-xs mr-1"}," 对外共享+1 ",-1)),Oa=[Da],Aa={key:2},za=de(()=>e("div",{class:"inline-flex items-center align-middle justify-center font-medium border border-red-50 bg-red-50 text-red-600 rounded-sm px-1 text-xs mr-1"}," 已过期 ",-1)),La=[za],Ta={key:3},Ua=de(()=>e("div",{class:"inline-flex items-center align-middle justify-center font-medium border border-gray-200 bg-gray-200 text-gray-600 rounded-sm px-1 text-xs mr-1"}," 永不过期 ",-1)),Ha=[Ua],Va={key:4},Ga={class:"inline-flex items-center align-middle justify-center font-medium border border-gray-200 bg-gray-200 text-gray-600 rounded-sm px-1 text-xs mr-1"},Ka={key:5},qa={class:"inline-flex items-center align-middle justify-center font-medium border border-blue-50 bg-blue-50 text-blue-600 rounded-sm px-1 text-xs mr-1"},Fa={key:0,class:"tooltip","data-tip":"该设备存在未批准子网转发，请在设备菜单的“编辑子网转发…”中检查"},Wa=de(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.35","stroke-linecap":"round","stroke-linejoin":"round",class:"ml-1"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})],-1)),Qa=[Wa],Za={key:6},Xa={class:"inline-flex items-center align-middle justify-center font-medium border border-blue-50 bg-blue-50 text-blue-600 rounded-sm px-1 text-xs mr-1"},Ya={key:0,class:"tooltip","data-tip":"该设备申请被用作出口节点，请在设备菜单的“编辑子网转发…”中检查"},Ja=de(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.35","stroke-linecap":"round","stroke-linejoin":"round",class:"ml-1"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})],-1)),el=[Ja],tl={class:"hidden md:table-cell md:w-1/4"},sl={class:"font-medium pr-6"},nl={class:"truncate"},ol={key:0,class:"absolute -mt-1 -ml-2 -top-px -left-px shadow-md cursor-pointer rounded-md active:shadow-sm transition-shadow duration-100 ease-in-out z-20",style:{visibility:"visible","max-width":"934px"}},al={class:"flex border rounded-md button-outline bg-white"},ll={class:"inline-block select-none truncate"},il=de(()=>e("span",{class:"cursor-pointer text-blue-500 pl-2"},"复制",-1)),rl={class:"tooltip text-gray-400","data-tip":"这条子网转发未启用"},dl=de(()=>e("br",null,null,-1)),cl={class:"hidden md:table-cell w-1/4 lg:w-1/5"},ul={class:"flex items-center relative"},vl={class:"text-sm text-gray-600"},hl={class:"hidden lg:table-cell md:flex-auto"},fl={class:"inline-flex items-center cursor-default"},ml=["data-tip"],pl=["data-tip"],bl={class:"table-cell justify-end ml-auto md:ml-0 relative w-12 justify-items-end items-center md:items-start"},gl=["onClick"],xl=_e('<button class="py-0.5 px-2 shadow-none rounded-md border border-gray-300/0 hover:border-gray-300/100 hover:bg-gray-100 hover:shadow-md hover:cursor-pointer active:border-gray-300/100 active:shadow focus:outline-none focus:ring transition-shadow duration-100 ease-in-out z-20" data-v-f9316f52><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-500" data-v-f9316f52><circle cx="12" cy="12" r="1" data-v-f9316f52></circle><circle cx="19" cy="12" r="1" data-v-f9316f52></circle><circle cx="5" cy="12" r="1" data-v-f9316f52></circle></svg></button>',1),_l=[xl],yl=["onClick"],wl=de(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"text-gray-500"},[e("circle",{cx:"12",cy:"12",r:"1"}),e("circle",{cx:"19",cy:"12",r:"1"}),e("circle",{cx:"5",cy:"12",r:"1"})],-1)),kl=[wl],$l={__name:"Machines",setup(t){const n=_(null),s=_(0),l=_(0);function a(){var I,y;n.value!=null&&(s.value=((I=n.value)==null?void 0:I.getBoundingClientRect().left)+14,l.value=(y=n.value)==null?void 0:y.getBoundingClientRect().top)}function v(I,y){var C,k,W,q;for(n.value=y.target;((C=n.value)==null?void 0:C.tagName)!="DIV"&&((k=n.value)==null?void 0:k.tagName)!="div";)n.value=n.value.parentNode;u.value=I,s.value=((W=n.value)==null?void 0:W.getBoundingClientRect().left)+14,l.value=(q=n.value)==null?void 0:q.getBoundingClientRect().top,f.value=!0}function p(){n.value=null,f.value=!1}const i=_(!1),d=_("");fe(i,()=>{i.value&&setTimeout(function(){i.value=!1},5e3)});const u=_("-1");function r(I){u.value=I,g.value=!0}function c(){g.value=!1}const o=_(!1),f=_(!1),g=_(!1),P=_(!1);function M(){g.value=!1,p(u.value),P.value=!0}const S=_(!1);function w(){g.value=!1,p(u.value),S.value=!0}const B=_(!1);function b(){g.value=!1,p(u.value),B.value=!0}const N=_({}),U=V(()=>Object.getOwnPropertyNames(N.value).length);let X;function pe(){return new Promise((I,y)=>{axios.get("/admin/api/machines").then(function(C){if((C.data.needreauth!=null||C.data.needreauth==!0)&&(d.value=C.data.needreauthreason+"，登录状态失效，请重新登录",i.value=!0,y()),C.data.errormsg==null||C.data.errormsg===""){for(var k in C.data.mlist){N.value[k]=C.data.mlist[k];let W=N.value[k].expirydesc.slice(-2),q=N.value[k].expirydesc.slice(-3);N.value[k].expirydesc=="马上就要过期"||W=="分钟"||W=="小时"||q=="剩1天"?N.value[k].soonexpiry=!0:N.value[k].soonexpiry=!1}I()}else C.data.errormsg!=null&&(d.value="获设备信息出错："+C.data.errormsg,i.value=!0,y())}).catch(function(C){d.value="更新页面出错："+C,i.value=!0,y()}).then(function(){})})}xe(()=>{a(),window.addEventListener("resize",a),window.addEventListener("scroll",a),pe().then().catch(),X=setInterval(()=>{pe().then().catch()},15e3)}),Mt(()=>{window.removeEventListener("resize",a),window.removeEventListener("scroll",a)}),Ys(()=>{clearInterval(X)});function $e(I){p(),axios.post("/admin/api/machines",{mid:I,state:"set-expires"}).then(function(y){y.data.status=="success"?(N.value[I].neverExpires=y.data.data.neverExpires,N.value[I].expirydesc=y.data.data.expires,y.data.data.neverExpires==!0?d.value="已禁用密钥过期":d.value="已启用密钥过期",i.value=!0):(d.value="失败："+y.data.status.substring(6),i.value=!0)}).catch(function(y){console.log(y)})}function Se(I){axios.post("/admin/api/machine/remove",{mid:I}).then(function(y){y.data.status=="OK"?(P.value=!1,d.value=N.value[I].name+"已从您的蜃境网络移除！",i.value=!0,delete N.value[I]):alert("失败："+y.data.errmsg)}).catch(function(y){console.log(y)})}function be(I,y,C){N.value[u.value].name=I,N.value[u.value].automaticNameMode=y,Be(()=>{S.value=!C,Be(()=>{d.value="已更新设备名称！",i.value=!0})})}function ce(I){d.value="更新设备名称失败！",i.value=!0}function ye(I,y,C,k){N.value[u.value].advertisedIPs=I,N.value[u.value].allowedIPs=y,N.value[u.value].extraIPs=C,N.value[u.value].allowedExitNode=k,Be(()=>{d.value="已更新子网转发设置！",i.value=!0})}function A(I){d.value="更新子网转发设置失败！",i.value=!0}function H(){navigator.clipboard.writeText(N.value[u.value].addresses[0]).then(function(){d.value="蜃境网络IPv4地址已复制到粘贴板！",i.value=!0})}function F(){navigator.clipboard.writeText(N.value[u.value].addresses[1]).then(function(){d.value="蜃境网络IPv6地址已复制到粘贴板！",i.value=!0})}return(I,y)=>{const C=We("router-link");return h(),m(Y,null,[e("main",fa,[e("section",ma,[pa,e("div",ba,E(O(U))+" 个设备 ",1),e("table",ga,[xa,e("tbody",null,[(h(!0),m(Y,null,re(N.value,(k,W)=>(h(),m("tr",{id:W,"v-if":N.value[W]!=I.nil,onMouseenter:q=>r(W),onMouseleave:q=>c(),class:"w-full px-0.5 hover"},[e("td",ya,[le(C,{class:"relative",to:"/machines/"+k.addresses[0]},{default:ve(()=>[e("div",wa,[e("p",ka,[e("span",{class:ne([{"bg-green-500":k.connectedToControl,"bg-gray-300":!k.connectedToControl},"inline-block w-2 h-2 rounded-full relative -top-px lg:hidden mr-2"])},null,2),e("a",$a,E(k.name),1)]),e("div",Sa,[e("span",Ca,E(k.addresses[0]),1),Na,e("span",Ea,E(k.os),1)])]),e("div",null,[e("div",Ra,[e("span",null,E(k.user),1)])])]),_:2},1032,["to"]),e("div",Pa,[e("div",null,[k.isExternal?(h(),m("span",ja,Ia)):$("",!0),k.issharedout?(h(),m("span",Ba,Oa)):$("",!0),k.expirydesc=="已过期"?(h(),m("span",Aa,La)):$("",!0),k.neverExpires?(h(),m("span",Ta,Ha)):$("",!0),k.soonexpiry?(h(),m("span",Va,[e("div",Ga,E(k.expirydesc),1)])):$("",!0),k.hasSubnets?(h(),m("span",Ka,[e("div",qa,[K(" 子网转发 "),k.hasSubnets&&k.extraIPs&&k.extraIPs.length>0?(h(),m("div",Fa,Qa)):$("",!0)])])):$("",!0),k.advertisedExitNode?(h(),m("span",Za,[e("div",Xa,[K(" 出口节点 "),k.allowedExitNode?$("",!0):(h(),m("div",Ya,el))])])):$("",!0)])])]),e("td",tl,[e("ul",null,[e("li",sl,[e("div",{onMouseenter:y[0]||(y[0]=q=>o.value=!0),onMouseleave:y[1]||(y[1]=q=>o.value=!1),class:"flex relative min-w-0"},[e("div",nl,[e("span",null,E(k.addresses[0]),1)]),o.value&&u.value==W?(h(),m("div",ol,[e("div",al,[e("div",{onClick:H,class:"flex min-w-0 py-1 px-2 hover:bg-gray-100 rounded-l-md"},[e("span",ll,[e("span",null,E(k.addresses[0]),1)]),il]),e("div",{onClick:F,class:"text-blue-500 py-1 px-2 border-l hover:bg-gray-100 rounded-r-md"}," IPv6 ")])])):$("",!0)],32)]),(h(!0),m(Y,null,re(k.allowedIPs,q=>(h(),m("li",null,[e("span",null,E(q),1)]))),256)),(h(!0),m(Y,null,re(k.extraIPs,q=>(h(),m(Y,null,[e("li",rl,[e("span",null,E(q),1)]),dl],64))),256))])]),e("td",cl,[e("div",ul,[e("div",null,E(k.os),1)]),e("div",vl,E(k.ipnVersion),1)]),e("td",hl,[e("span",null,[e("div",fl,[e("span",{class:ne(["inline-block w-2 h-2 rounded-full mr-2",{"bg-green-500":k.connectedToControl,"bg-gray-300":!k.connectedToControl}])},null,2),k.connectedToControl?(h(),m("span",{key:0,class:"text-sm text-gray-600 tooltip tooltip-top","data-tip":"最近在线于"+k.lastSeen},"已连接",8,ml)):(h(),m("span",{key:1,class:"text-sm text-gray-600 tooltip tooltip-top","data-tip":"最近在线于"+k.lastSeen},E(k.lastSeen),9,pl))])])]),e("td",bl,[!g.value&&!f.value||u.value!=W?(h(),m("div",{key:0,onClick:q=>v(W,q),class:"flex-none w-12 -mt-0.5 relative"},_l,8,gl)):$("",!0),(g.value||f.value)&&u.value==W?(h(),m("div",{key:1,onClick:q=>v(W,q),class:"flex-none w-12 border button-outline bg-white shadow-md cursor-pointer focus:outline-none focus:ring -mt-0.5 relative py-0.5 px-2 rounded-md border-gray-300/100 hover:border-gray-300/100 hover:bg-gray-100 hover:shadow-md hover:cursor-pointer active:border-gray-300/100 transition-shadow duration-100 ease-in-out z-20"},kl,8,yl)):$("",!0)])],40,_a))),256))])])])]),(h(),Z(he,{to:".toast-container"},[le(Ye,{show:i.value,msg:d.value,onClose:y[2]||(y[2]=k=>i.value=!1)},null,8,["show","msg"])])),(h(),Z(he,{to:"body"},[f.value?(h(),Z(Ft,{key:0,toleft:s.value,totop:l.value,neverExpires:N.value[u.value].neverExpires,onClose:p,onSetExpires:y[3]||(y[3]=k=>$e(u.value)),onShowdialogRemove:M,onShowdialogUpdatehostname:w,onShowdialogSetsubnet:b},null,8,["toleft","totop","neverExpires"])):$("",!0)])),(h(),Z(he,{to:"body"},[P.value?(h(),Z(Wt,{key:0,"machine-name":N.value[u.value].name,onClose:y[4]||(y[4]=k=>P.value=!1),onConfirm:y[5]||(y[5]=k=>Se(u.value))},null,8,["machine-name"])):$("",!0),S.value?(h(),Z(Qt,{key:1,id:u.value,"given-name":N.value[u.value].name,"host-name":N.value[u.value].hostname,"auto-gen":N.value[u.value].automaticNameMode,onClose:y[6]||(y[6]=k=>S.value=!1),onUpdateDone:be,onUpdateFail:ce},null,8,["id","given-name","host-name","auto-gen"])):$("",!0),B.value?(h(),Z(Zt,{key:2,id:u.value,"current-machine":N.value[u.value],onClose:y[7]||(y[7]=k=>B.value=!1),onUpdateDone:ye,onUpdateFail:A},null,8,["id","current-machine"])):$("",!0)]))],64)}}},Sl=Re($l,[["__scopeId","data-v-f9316f52"]]);const z=t=>(Pe("data-v-7725cec0"),t=t(),je(),t),Cl={key:0,class:"container mx-auto pb-20 md:pb-24"},Nl={class:"mb-24"},El={class:"w-full p-3 flex items-center justify-center text-sm"},Rl={class:"flex items-center justify-center"},Pl=z(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"mr-3 text-red-400 h-5 w-5"},[e("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),e("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),e("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})],-1)),jl=z(()=>e("strong",null,"错误：",-1)),Ml={key:1,class:"container mx-auto pb-20 md:pb-24"},Il={class:"mb-24"},Bl={class:"pb-4 mb-8"},Dl={class:"font-medium space-x-2 mb-5 truncate flex"},Ol=z(()=>e("span",{class:"text-gray-400"},"/",-1)),Al={class:"flex flex-wrap gap-2 items-center justify-between"},zl={class:"text-2xl font-semibold tracking-tight leading-tight truncate flex-shrink-0 max-w-full",tabindex:"-1"},Ll={class:"flex"},Tl={class:"flex gap-2 flex-wrap"},Ul=z(()=>e("div",{class:"flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"mr-2"},[e("circle",{cx:"12",cy:"12",r:"3"}),e("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]),K("设备设置 ")],-1)),Hl=[Ul],Vl={class:"flex border-t border-gray-200 text-sm mt-4 pt-4"},Gl={class:"max-w-sm"},Kl=z(()=>e("div",{class:"text-gray-500 mb-2"},"归属于",-1)),ql={class:"mt-0.5"},Fl={class:"flex items-center text-gray-600 text-sm"},Wl={class:"relative shrink-0 rounded-full overflow-hidden w-5 h-5 text-xs mr-2"},Ql={class:"flex items-center justify-center text-center capitalize text-white font-medium pointer-events-none w-5 h-5 text-xs",style:{"background-color":"rgb(161, 56, 33)"}},Zl={"data-state":"closed"},Xl={key:0,class:"max-w-sm border-l border-gray-200 ml-4 pl-4"},Yl=z(()=>e("p",{class:"text-gray-500 mb-2"},"状态",-1)),Jl={key:0},ei=z(()=>e("div",{class:"inline-flex items-center align-middle justify-center font-medium border border-orange-50 bg-orange-50 text-orange-600 rounded-sm px-1 text-xs mr-1"}," 外部共享 ",-1)),ti=[ei],si={key:1},ni=z(()=>e("div",{class:"inline-flex items-center align-middle justify-center font-medium border border-orange-50 bg-orange-50 text-orange-600 rounded-sm px-1 text-xs mr-1"}," 对外共享+1 ",-1)),oi=[ni],ai={key:2},li=z(()=>e("div",{class:"inline-flex items-center align-middle justify-center font-medium border border-red-50 bg-red-50 text-red-600 rounded-sm px-1 text-xs mr-1"}," 已过期 ",-1)),ii=[li],ri={key:3},di=z(()=>e("div",{class:"inline-flex items-center align-middle justify-center font-medium border border-gray-200 bg-gray-200 text-gray-600 rounded-sm px-1 text-xs mr-1"}," 永不过期 ",-1)),ci=[di],ui={key:4},vi={class:"inline-flex items-center align-middle justify-center font-medium border border-gray-200 bg-gray-200 text-gray-600 rounded-sm px-1 text-xs mr-1"},hi={key:5},fi={class:"inline-flex items-center align-middle justify-center font-medium border border-blue-50 bg-blue-50 text-blue-600 rounded-sm px-1 text-xs mr-1"},mi={key:0,class:"tooltip","data-tip":"该设备存在未批准子网转发，请在设备菜单的“编辑子网转发…”中检查"},pi=z(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.35","stroke-linecap":"round","stroke-linejoin":"round",class:"ml-1"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})],-1)),bi=[pi],gi={key:6},xi={class:"inline-flex items-center align-middle justify-center font-medium border border-blue-50 bg-blue-50 text-blue-600 rounded-sm px-1 text-xs mr-1"},_i={key:0,class:"tooltip","data-tip":"该设备申请被用作出口节点，请在设备菜单的“编辑子网转发…”中检查"},yi=z(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.35","stroke-linecap":"round","stroke-linejoin":"round",class:"ml-1"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})],-1)),wi=[yi],ki={class:"mb-8"},$i={class:"flex justify-between mb-4"},Si=z(()=>e("div",{class:"max-w-xl"},[e("h3",{class:"text-xl font-semibold tracking-tight mb-2"},"子网转发"),e("p",{class:"text-gray-600"}," “子网转发”允许你暴露设备可访问物理网络路由给您的蜃境网络 ")],-1)),Ci={key:0},Ni={key:0,class:"p-4 md:p-6 border border-gray-200 rounded-md"},Ei={class:"leading-normal"},Ri={class:"tooltip text-gray-400","data-tip":"这条子网转发未启用"},Pi=z(()=>e("br",null,null,-1)),ji={key:1,class:"p-4 md:p-6 border border-gray-200 rounded-md flex items-center justify-center text-gray-500 text-center"},Mi=z(()=>e("div",{class:"flex justify-center"},[e("div",{class:"w-full text-center max-w-xl text-gray-500"}," 该设备未暴露任何子网可供转发 ")],-1)),Ii=[Mi],Bi={key:2,class:"p-4 md:p-6 border border-gray-200 rounded-md flex items-center justify-center text-gray-500 text-center"},Di=z(()=>e("div",{class:"flex justify-center"},[e("div",{class:"w-full text-center max-w-xl text-gray-500"}," 该设备来自外部共享，不能暴露子网转发给你 ")],-1)),Oi=[Di],Ai={class:"mb-8"},zi=z(()=>e("header",{class:"max-w-xl mb-4"},[e("h3",{class:"text-xl font-semibold tracking-tight mb-2"},"设备信息"),e("p",{class:"text-gray-600"},"关于该设备网络的信息，用于调试连接问题")],-1)),Li={class:"p-4 md:p-6 border border-gray-200 rounded-md grid grid-cols-1 md:grid-cols-2 gap-y-2 gap-x-2"},Ti={class:"space-y-2"},Ui={class:"flex text-sm"},Hi=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"创建者",-1)),Vi={class:"min-w-0 truncate"},Gi={class:"flex text-sm"},Ki=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"设备名称",-1)),qi={class:"min-w-0"},Fi={class:"flex relative min-w-0"},Wi={class:"truncate"},Qi={key:0,class:"cursor-pointer text-blue-500 pl-2"},Zi={class:"flex text-sm"},Xi=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"域名",-1)),Yi={class:"min-w-0"},Ji={class:"flex relative min-w-0"},er={class:"truncate"},tr={key:0,class:"cursor-pointer text-blue-500 pl-2"},sr={class:"flex text-sm"},nr=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"系统主机名",-1)),or={class:"min-w-0 truncate"},ar={class:"flex text-sm"},lr=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"操作系统",-1)),ir={class:"min-w-0 truncate"},rr={class:"flex text-sm"},dr=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"蜃境客户端版本",-1)),cr={class:"min-w-0 truncate"},ur={class:"flex items-center"},vr={class:"flex text-sm"},hr=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"蜃境网络 IPv4",-1)),fr={class:"min-w-0"},mr={class:"flex relative min-w-0"},pr={class:"truncate"},br={key:0,class:"cursor-pointer text-blue-500 pl-2"},gr={class:"flex text-sm"},xr=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"蜃境网络 IPv6",-1)),_r={class:"min-w-0"},yr={class:"flex relative min-w-0"},wr={class:"truncate"},kr={class:"inline-flex justify-start min-w-0 max-w-full"},$r={class:"truncate w-fit flex-shrink"},Sr={key:0,class:"cursor-pointer text-blue-500 pl-2"},Cr={class:"flex text-sm"},Nr=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"设备ID",-1)),Er={class:"min-w-0 truncate"},Rr={class:"flex text-sm"},Pr=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"设备端点信息",-1)),jr={class:"min-w-0 truncate"},Mr={class:"pl-3 -indent-3"},Ir={class:"select-all"},Br={class:"flex text-sm"},Dr=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"中继器",-1)),Or={class:"min-w-0 truncate"},Ar={key:0},zr=z(()=>e("li",null," 中继器未设定或出错 ",-1)),Lr=[zr],Tr={key:1},Ur={class:"font-medium"},Hr={key:0,xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"relative inline-block ml-1 -top-px"},Vr=z(()=>e("polyline",{points:"20 6 9 17 4 12"},null,-1)),Gr=[Vr],Kr={class:"space-y-2"},qr={class:"flex text-sm"},Fr=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"创建于",-1)),Wr={class:"min-w-0 truncate"},Qr={class:"flex text-sm"},Zr=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"最近更新",-1)),Xr={class:"min-w-0 truncate"},Yr={class:"flex text-sm"},Jr=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"密钥过期",-1)),ed={key:0,class:"min-w-0 truncate"},td={key:1,class:"min-w-0 truncate"},sd=z(()=>e("h2",{class:"pt-2 text-xs uppercase font-semibold text-gray-500 tracking-wide"}," 客户端连通性 ",-1)),nd={class:"flex text-sm"},od=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"复杂网络 Varies",-1)),ad={key:0,class:"min-w-0 truncate"},ld={key:1,class:"min-w-0 truncate"},id={class:"flex text-sm"},rd=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"}," 需发夹机制 Hairpinning ",-1)),dd={key:0,class:"min-w-0 truncate"},cd={key:1,class:"min-w-0 truncate"},ud={class:"flex text-sm"},vd=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"IPv6",-1)),hd={key:0,class:"min-w-0 truncate"},fd={key:1,class:"min-w-0 truncate"},md={class:"flex text-sm"},pd=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"UDP",-1)),bd={key:0,class:"min-w-0 truncate"},gd={key:1,class:"min-w-0 truncate"},xd={class:"flex text-sm"},_d=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"UPnP",-1)),yd={key:0,class:"min-w-0 truncate"},wd={key:1,class:"min-w-0 truncate"},kd={class:"flex text-sm"},$d=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"PCP",-1)),Sd={key:0,class:"min-w-0 truncate"},Cd={key:1,class:"min-w-0 truncate"},Nd={class:"flex text-sm"},Ed=z(()=>e("dt",{class:"text-gray-500 w-1/3 md:w-1/4 mr-1 shrink-0"},"NAT-PMP",-1)),Rd={key:0,class:"min-w-0 truncate"},Pd={key:1,class:"min-w-0 truncate"},jd={__name:"Machine",setup(t){const n=_(!1),s=ht(),l=ft(),a=_(!1),v=_("");fe(a,()=>{a.value&&setTimeout(function(){a.value=!1},5e3)});const p=V(()=>b.value.isExternal||b.value.issharedout||b.value.expirydesc=="已过期"||b.value.neverExpires||b.value.soonexpiry||b.value.advertisedExitNode||b.value.hasSubnets),i=_(null),d=_(0),u=_(0),r=_(!1);function c(){var A,H;i.value!=null&&(d.value=((A=i.value)==null?void 0:A.getBoundingClientRect().left)+78,u.value=((H=i.value)==null?void 0:H.getBoundingClientRect().top)+20),window.onresize=()=>{var F,I;i.value!=null&&(d.value=((F=i.value)==null?void 0:F.getBoundingClientRect().left)+78,u.value=((I=i.value)==null?void 0:I.getBoundingClientRect().top)+20)},window.onscroll=()=>{var F,I;i.value!=null&&(d.value=((F=i.value)==null?void 0:F.getBoundingClientRect().left)+78,u.value=((I=i.value)==null?void 0:I.getBoundingClientRect().top)+20)}}function o(A){var H,F,I,y,C;for(i.value=A.target;((H=i.value)==null?void 0:H.tagName)!="BUTTON"&&((F=i.value)==null?void 0:F.tagName)!="button";)i.value=(I=i.value)==null?void 0:I.parentNode;d.value=((y=i.value)==null?void 0:y.getBoundingClientRect().left)+78,u.value=((C=i.value)==null?void 0:C.getBoundingClientRect().top)+20,r.value=!0}function f(){i.value=null,r.value=!1}const g=_(!1);function P(){f(),g.value=!0}const M=_(!1);function S(){f(),M.value=!0}const w=_(!1);function B(){f(),w.value=!0}const b=_({}),N=_(""),U=_(!1),X=_("");xe(()=>{c(),axios.get("/admin/api/machines").then(function(A){if((A.data.needreauth!=null||A.data.needreauth==!0)&&(v.value=A.data.needreauthreason+"，登录状态失效，请重新登录",a.value=!0,reject()),A.data.errormsg==null||A.data.errormsg===""){X.value=A.data.basedomain;for(var H in A.data.mlist)if(A.data.mlist[H].addresses[0]===l.params.mip){b.value=A.data.mlist[H],N.value=H;let F=b.value.expirydesc.slice(-2),I=b.value.expirydesc.slice(-3);b.value.expirydesc=="马上就要过期"||F=="分钟"||F=="小时"||I=="剩1天"?b.value.soonexpiry=!0:b.value.soonexpiry=!1;break}N.value==""&&(U.value=!0)}}).catch(function(A){alert(A)}).then(function(){})});function pe(){f(),axios.post("/admin/api/machines",{mid:N.value,state:"set-expires"}).then(function(A){A.data.status=="success"?(b.value.neverExpires=A.data.data.neverExpires,b.value.expirydesc=A.data.data.expires,A.data.data.neverExpires==!0?v.value="已禁用密钥过期":v.value="已启用密钥过期",a.value=!0):(v.value="失败："+A.data.status.substring(6),a.value=!0)}).catch(function(A){console.log(A)})}function $e(){axios.post("/admin/api/machine/remove",{mid:N}).then(function(A){A.data.status=="OK"?(g.value=!1,v.value=b.value.name+"已从您的蜃境网络移除！",a.value=!0,s.push("/machines")):alert("失败："+A.data.errmsg)}).catch(function(A){console.log(A)})}function Se(A,H,F){b.value.name=A,b.value.automaticNameMode=H,Be(()=>{M.value=!F,Be(()=>{v.value="已更新设备名称！",a.value=!0})})}function be(A){v.value="更新设备名称失败！",a.value=!0}function ce(A,H,F,I){b.value.advertisedIPs=A,b.value.allowedIPs=H,b.value.extraIPs=F,b.value.allowedExitNode=I,Be(()=>{v.value="已更新子网转发设置！",a.value=!0})}function ye(A){v.value="更新子网转发设置失败！",a.value=!0}return(A,H)=>{const F=We("router-link");return h(),m(Y,null,[U.value?(h(),m("main",Cl,[e("section",Nl,[e("div",El,[e("div",Rl,[Pl,e("div",null,[jl,K(" 没发现IP为 "+E(O(l).params.mip)+" 的设备",1)])])])])])):$("",!0),U.value?$("",!0):(h(),m("main",Ml,[e("section",Il,[e("header",Bl,[e("div",Dl,[le(F,{to:"/machines",class:"text-blue-500"},{default:ve(()=>[K("全部设备")]),_:1}),Ol,e("span",null,E(b.value.addresses[0]),1)]),e("div",Al,[e("h1",zl,E(b.value.name),1),e("div",Ll,[e("div",Tl,[e("button",{onClick:H[0]||(H[0]=I=>o(I)),class:"btn btn-outline bg-gray-50 border-gray-300 text-gray-700 hover:bg-gray-100 hover:border-gray-300 hover:text-gray-700 min-w-0"},Hl)])])]),e("div",Vl,[e("div",Gl,[Kl,e("div",ql,[e("div",Fl,[e("div",Wl,[e("div",Ql,E(b.value.usernamehead),1)]),e("span",Zl,E(b.value.user),1)])])]),O(p)?(h(),m("div",Xl,[Yl,e("div",null,[b.value.isExternal?(h(),m("span",Jl,ti)):$("",!0),b.value.issharedout?(h(),m("span",si,oi)):$("",!0),b.value.expirydesc=="已过期"?(h(),m("span",ai,ii)):$("",!0),b.value.neverExpires?(h(),m("span",ri,ci)):$("",!0),b.value.soonexpiry?(h(),m("span",ui,[e("div",vi,E(b.value.expirydesc),1)])):$("",!0),b.value.hasSubnets?(h(),m("span",hi,[e("div",fi,[K(" 子网转发 "),b.value.hasSubnets&&b.value.extraIPs&&b.value.extraIPs.length>0?(h(),m("div",mi,bi)):$("",!0)])])):$("",!0),b.value.advertisedExitNode?(h(),m("span",gi,[e("div",xi,[K(" 出口节点 "),b.value.allowedExitNode?$("",!0):(h(),m("div",_i,wi))])])):$("",!0)])])):$("",!0)])]),e("section",ki,[e("header",$i,[Si,b.value.hasSubnets?(h(),m("div",Ci,[e("button",{onClick:B,class:"btn btn-outline bg-gray-50 border-gray-300 text-gray-700 hover:bg-gray-100 hover:border-gray-300 hover:text-gray-700 mt-2"}," 配置 ")])):$("",!0)]),b.value.hasSubnets?(h(),m("div",Ni,[e("ul",Ei,[(h(!0),m(Y,null,re(b.value.allowedIPs,I=>(h(),m("li",null,[e("span",null,E(I),1)]))),256)),(h(!0),m(Y,null,re(b.value.extraIPs,I=>(h(),m(Y,null,[e("li",Ri,[e("span",null,E(I),1)]),Pi],64))),256))])])):$("",!0),!b.value.hasSubnets&&!b.value.isExternal?(h(),m("div",ji,Ii)):$("",!0),b.value.isExternal?(h(),m("div",Bi,Oi)):$("",!0)]),e("section",Ai,[zi,e("div",Li,[e("div",Ti,[e("dl",Ui,[Hi,e("dd",Vi,E(b.value.user),1)]),e("dl",Gi,[Ki,e("dd",qi,[e("div",Fi,[e("div",Wi,E(b.value.name),1),n.value?(h(),m("div",Qi,"复制")):$("",!0)])])]),e("dl",Zi,[Xi,e("dd",Yi,[e("div",Ji,[e("div",er,E(b.value.name)+"."+E(b.value.user)+"."+E(X.value),1),n.value?(h(),m("div",tr,"复制")):$("",!0)])])]),e("dl",sr,[nr,e("dd",or,E(b.value.hostname),1)]),e("dl",ar,[lr,e("dd",ir,E(b.value.os),1)]),e("dl",rr,[dr,e("dd",cr,[e("div",ur,E(b.value.ipnVersion),1)])]),e("dl",vr,[hr,e("dd",fr,[e("div",mr,[e("div",pr,[e("span",null,E(b.value.addresses[0]),1)]),n.value?(h(),m("div",br,"复制")):$("",!0)])])]),e("dl",gr,[xr,e("dd",_r,[e("div",yr,[e("div",wr,[e("span",kr,[e("span",$r,E(b.value.addresses[1]),1)])]),n.value?(h(),m("div",Sr,"复制")):$("",!0)])])]),e("dl",Cr,[Nr,e("dd",Er,E(N.value),1)]),e("dl",Rr,[Pr,e("dd",jr,[e("ul",Mr,[(h(!0),m(Y,null,re(b.value.endpoints,I=>(h(),m("li",Ir,[e("span",null,E(I),1)]))),256))])])]),e("dl",Br,[Dr,e("dd",Or,[b.value.usederp=="x"?(h(),m("ul",Ar,Lr)):(h(),m("ul",Tr,[(h(!0),m(Y,null,re(b.value.derps,(I,y)=>(h(),m("li",null,[e("strong",Ur,E(y)+" 号中继",1),K(": "+E(I)+" ms ",1),b.value.usederp==y?(h(),m("svg",Hr,Gr)):$("",!0)]))),256))]))])])]),e("div",Kr,[e("dl",qr,[Fr,e("dd",Wr,E(b.value.created),1)]),e("dl",Qr,[Zr,e("dd",Xr,E(b.value.lastSeen),1)]),e("dl",Yr,[Jr,b.value.neverExpires?(h(),m("dd",ed," 永不过期 ")):$("",!0),b.value.neverExpires?$("",!0):(h(),m("dd",td,E(b.value.expirydesc),1))]),sd,e("dl",nd,[od,b.value.varies?(h(),m("dd",ad,"是")):(h(),m("dd",ld,"否"))]),e("dl",id,[rd,b.value.hairpinning?(h(),m("dd",dd,"是")):(h(),m("dd",cd,"否"))]),e("dl",ud,[vd,b.value.ipv6en?(h(),m("dd",hd,"是")):(h(),m("dd",fd,"否"))]),e("dl",md,[pd,b.value.udpen?(h(),m("dd",bd,"是")):(h(),m("dd",gd,"否"))]),e("dl",xd,[_d,b.value.upnpen?(h(),m("dd",yd,"是")):(h(),m("dd",wd,"否"))]),e("dl",kd,[$d,b.value.pcpen?(h(),m("dd",Sd,"是")):(h(),m("dd",Cd,"否"))]),e("dl",Nd,[Ed,b.value.pmpen?(h(),m("dd",Rd,"是")):(h(),m("dd",Pd,"否"))])])])])])])),(h(),Z(he,{to:".toast-container"},[le(Ye,{show:a.value,msg:v.value,onClose:H[1]||(H[1]=I=>a.value=!1)},null,8,["show","msg"])])),(h(),Z(he,{to:"body"},[r.value?(h(),Z(Ft,{key:0,toleft:d.value,totop:u.value,neverExpires:b.value.neverExpires,onClose:f,onSetExpires:pe,onShowdialogRemove:P,onShowdialogUpdatehostname:S,onShowdialogSetsubnet:B},null,8,["toleft","totop","neverExpires"])):$("",!0)])),(h(),Z(he,{to:"body"},[g.value?(h(),Z(Wt,{key:0,"machine-name":b.value.name,onClose:H[2]||(H[2]=I=>g.value=!1),onConfirm:$e},null,8,["machine-name"])):$("",!0),M.value?(h(),Z(Qt,{key:1,id:N.value,"host-name":b.value.hostname,"given-name":b.value.name,"auto-gen":b.value.automaticNameMode,onClose:H[3]||(H[3]=I=>M.value=!1),onUpdateDone:Se,onUpdateFail:be},null,8,["id","host-name","given-name","auto-gen"])):$("",!0),w.value?(h(),Z(Zt,{key:2,id:N.value,"current-machine":b.value,onClose:H[4]||(H[4]=I=>w.value=!1),onUpdateDone:ce,onUpdateFail:ye},null,8,["id","current-machine"])):$("",!0)]))],64)}}},Md=Re(jd,[["__scopeId","data-v-7725cec0"]]);const Oe=t=>(Pe("data-v-75164fa0"),t=t(),je(),t),Id={class:"bg-white rounded-lg relative p-4 md:p-6 text-gray-700 max-w-lg min-w-[19rem] my-8 mx-auto w-[97%] shadow-2xl",tabindex:"-1",style:{"pointer-events":"auto"}},Bd=Oe(()=>e("header",{class:"flex items-center justify-between space-x-4 mb-5 mr-8"},[e("div",{class:"font-semibold text-lg truncate"},"添加域名服务器")],-1)),Dd={class:"mt-8 mb-8"},Od=Oe(()=>e("label",{class:"font-medium text-gray-900 block mb-1",for:"nameserver"},"域名服务器",-1)),Ad=Oe(()=>e("p",{class:"text-sm text-gray-600 mt-2"},"使用这个IPv4或IPv6地址来解析域名",-1)),zd={class:"relative mt-2"},Ld={key:0,class:"text-sm text-red-400 mt-1"},Td={key:1,class:"text-sm text-red-400 mt-1"},Ud={class:"sm:flex justify-between items-center"},Hd=_e('<div data-v-75164fa0><div class="flex items-center" data-v-75164fa0><label class="font-medium text-gray-900" for="restrict" data-v-75164fa0>分离 DNS</label><span data-state="closed" data-v-75164fa0><div class="inline-flex items-center align-middle justify-center font-medium border border-gray-200 bg-gray-200 text-gray-600 rounded-sm px-1 relative ml-2 text-xs" data-v-75164fa0><svg xmlns="http://www.w3.org/2000/svg" width="0.9em" height="0.9em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1" data-v-75164fa0><polyline points="16 3 21 3 21 8" data-v-75164fa0></polyline><line x1="4" y1="20" x2="21" y2="3" data-v-75164fa0></line><polyline points="21 16 21 21 16 21" data-v-75164fa0></polyline><line x1="15" y1="15" x2="21" y2="21" data-v-75164fa0></line><line x1="4" y1="4" x2="9" y2="9" data-v-75164fa0></line></svg>分离 DNS </div></span></div><p class="text-sm text-gray-600 hidden sm:block" data-v-75164fa0>此域名服务器将只用于部分域名解析</p></div>',1),Vd={"data-state":"closed"},Gd=Oe(()=>e("p",{class:"text-sm text-gray-600 sm:hidden"},"此域名服务器将只用于部分域名解析",-1)),Kd={key:0,class:"mt-4"},qd=Oe(()=>e("label",{class:"font-medium text-gray-900 block mb-1",for:"searchdomain"},"检索域",-1)),Fd={class:"relative mt-2"},Wd=Oe(()=>e("p",{class:"text-sm text-gray-600 mt-2"},"只用匹配此后缀的单一标签或完全限定查询将使用这个域名服务器",-1)),Qd={class:"flex mt-10 justify-end space-x-4"},Zd=["disabled"],Xd=Oe(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.25em",height:"1.25em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)),Yd=[Xd],Jd={__name:"AddNS",props:{currentDNS:Object},emits:["nameserver-added"],setup(t,{emit:n}){const s=t;Me();const l=_(!1),a=_(!1),v=_(!1),p=_(""),i=_(""),d=V(()=>p.value.length<6||v.value&&(!i.value||i.value.length==0));fe(()=>p.value,c=>{l.value=!1,a.value=!1,p.value=p.value.toLowerCase().replace(/[^\.:0-9a-f]/ig,"")}),fe(()=>i.value,c=>{i.value=i.value.replace(/[^\.:\/'\-_0-9a-zA-Z]/g,"")});const u=/((^\s*((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))\s*$)|(^\s*((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$))/;function r(){if(!u.test(p.value)){l.value=!0;return}var c=s.currentDNS;if(v.value){var f=!1;for(var o in c.domains)if(c.domains[o]==i.value){for(var g in c.routes[i.value])if(c.routes[i.value][g]==p.value){a.value=!0;return}c.routes[i.value]||(c.routes[i.value]=[]),c.routes[i.value].push(p.value),f=!0;break}f||(c.domains||(c.domains=[]),c.domains.push(i.value),c.routes[i.value]=[],c.routes[i.value].push(p.value))}else if(!s.currentDNS.resolvers||s.currentDNS.resolvers.length==0){for(var o in c.fallbackResolvers)if(c.fallbackResolvers[o]==p.value){a.value=!0;return}c.fallbackResolvers||(c.fallbackResolvers=[]),c.fallbackResolvers.push(p.value)}else{for(var o in c.resolvers)if(c.resolvers[o]==p.value){a.value=!0;return}c.resolvers.push(p.value)}axios.post("/admin/api/dns",c).then(function(P){P.data.status=="success"?n("nameserver-added",P.data.data):console.log(P.data.status)}).catch(function(P){console.log(P)})}return(c,o)=>(h(),m("div",{onClick:o[6]||(o[6]=J(f=>c.$emit("close"),["self"])),class:"fixed overflow-y-auto inset-0 py-8 z-30 bg-gray-900 bg-opacity-[0.07]",style:{"pointer-events":"auto"}},[e("div",Id,[Bd,e("form",{onSubmit:o[4]||(o[4]=J(()=>{},["prevent"]))},[e("div",Dd,[Od,Ad,e("div",zd,[ae(e("input",{"onUpdate:modelValue":o[0]||(o[0]=f=>p.value=f),class:ne([{"border-stone-200":!l.value&&!a.value,"border-red-400":l.value||a.value},"w-full px-3 z-30 border focus:outline-blue-500/60 hover:border disabled:hover:border-stone-200 disabled:border-stone-200 hover:border-stone-400 rounded-md h-9 min-h-fit tabular-nums"]),id:"nameserver",type:"text",placeholder:"1.2.3.4",autocapitalize:"off",autocomplete:"off"},null,2),[[De,p.value]])]),l.value?(h(),m("p",Ld,"不合法，只允许IPv4或IPv6地址")):$("",!0),a.value?(h(),m("p",Td,"该域名解析服务器条目已存在")):$("",!0)]),e("div",Ud,[Hd,e("span",Vd,[ae(e("input",{"onUpdate:modelValue":o[1]||(o[1]=f=>v.value=f),id:"restrict",type:"checkbox",class:"toggle toggle-large mt-2 sm:mt-0 self-start shrink-0"},null,512),[[Te,v.value]])]),Gd]),v.value?(h(),m("div",Kd,[qd,e("div",Fd,[ae(e("input",{"onUpdate:modelValue":o[2]||(o[2]=f=>i.value=f),class:"w-full px-3 z-30 border focus:outline-blue-500/60 hover:border disabled:hover:border-stone-200 disabled:border-stone-200 border-stone-200 hover:border-stone-400 rounded-md h-9 min-h-fit",id:"searchdomain",type:"text",placeholder:"example.com",autocapitalize:"off",autocomplete:"off"},null,512),[[De,i.value]])]),Wd])):$("",!0),e("footer",Qd,[e("button",{onClick:o[3]||(o[3]=f=>c.$emit("close")),class:"btn border border-base-300 hover:border-base-300 bg-base-200 hover:bg-base-300 text-black h-9 min-h-fit"},"取消"),e("button",{onClick:r,class:"btn border-0 bg-blue-500 hover:bg-blue-900 disabled:bg-blue-500/60 text-white disabled:text-white/60 h-9 min-h-fit",disabled:O(d)},"保存",8,Zd)])],32),e("button",{onClick:o[5]||(o[5]=f=>c.$emit("close")),class:"btn btn-sm btn-ghost absolute top-5 right-5 px-2 py-2 border-0 bg-base-0 focus:bg-base-200 hover:bg-base-200",type:"button"},Yd)])]))}},ec=Re(Jd,[["__scopeId","data-v-75164fa0"]]);const Ae=t=>(Pe("data-v-b94cc905"),t=t(),je(),t),tc={class:"bg-white rounded-lg relative p-4 md:p-6 text-gray-700 max-w-lg min-w-[19rem] my-8 mx-auto w-[97%] shadow-2xl",tabindex:"-1",style:{"pointer-events":"auto"}},sc=Ae(()=>e("header",{class:"flex items-center justify-between space-x-4 mb-5 mr-8"},[e("div",{class:"font-semibold text-lg truncate"},"编辑域名服务器")],-1)),nc={class:"mt-8 mb-8"},oc=Ae(()=>e("label",{class:"font-medium text-gray-900 block mb-1",for:"nameserver"},"域名服务器",-1)),ac=Ae(()=>e("p",{class:"text-sm text-gray-600 mt-2"},"使用这个IPv4或IPv6地址来解析域名",-1)),lc={class:"relative mt-2"},ic={key:0,class:"text-sm text-red-400 mt-1"},rc={key:1,class:"text-sm text-red-400 mt-1"},dc={class:"sm:flex justify-between items-center"},cc=_e('<div data-v-b94cc905><div class="flex items-center" data-v-b94cc905><label class="font-medium text-gray-900" for="restrict" data-v-b94cc905>分离 DNS</label><span data-state="closed" data-v-b94cc905><div class="inline-flex items-center align-middle justify-center font-medium border border-gray-200 bg-gray-200 text-gray-600 rounded-sm px-1 relative ml-2 text-xs" data-v-b94cc905><svg xmlns="http://www.w3.org/2000/svg" width="0.9em" height="0.9em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1" data-v-b94cc905><polyline points="16 3 21 3 21 8" data-v-b94cc905></polyline><line x1="4" y1="20" x2="21" y2="3" data-v-b94cc905></line><polyline points="21 16 21 21 16 21" data-v-b94cc905></polyline><line x1="15" y1="15" x2="21" y2="21" data-v-b94cc905></line><line x1="4" y1="4" x2="9" y2="9" data-v-b94cc905></line></svg>分离 DNS </div></span></div><p class="text-sm text-gray-600 hidden sm:block" data-v-b94cc905>此域名服务器将只用于部分域名解析</p></div>',1),uc={"data-state":"closed"},vc=Ae(()=>e("p",{class:"text-sm text-gray-600 sm:hidden"},"此域名服务器将只用于部分域名解析",-1)),hc={key:0,class:"mt-4"},fc=Ae(()=>e("label",{class:"font-medium text-gray-900 block mb-1",for:"searchdomain"},"检索域",-1)),mc={class:"relative mt-2"},pc=Ae(()=>e("p",{class:"text-sm text-gray-600 mt-2"},"只用匹配此后缀的单一标签或完全限定查询将使用这个域名服务器",-1)),bc={class:"flex mt-10 justify-end space-x-4"},gc=["disabled"],xc=Ae(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.25em",height:"1.25em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)),_c=[xc],yc={__name:"EditNS",props:{currentDNS:Object,OriDomain:String,OriResolver:String},emits:["nameserver-edited","close"],setup(t,{emit:n}){const s=t;Me();const l=V(()=>{var o=s.currentDNS;if(s.OriDomain==""){if(s.OriResolver=="")return o;if(!o.resolvers||o.resolvers.length==0){var f=[];for(var g in o.fallbackResolvers)o.fallbackResolvers[g]!=s.OriResolver&&f.push(o.fallbackResolvers[g]);return o.fallbackResolvers=f,o}else{var P=[];for(var g in o.resolvers)o.resolvers[g]!=s.OriResolver&&P.push(o.resolvers[g]);return o.resolvers=P,o}}else{if(s.OriResolver=="")return o;var M=[],S=[];for(var g in o.domains)if(o.domains[g]!=s.OriDomain)M.push(o.domains[g]);else{for(var w in o.routes[s.OriDomain])o.routes[s.OriDomain][w]!=s.OriResolver&&S.push(o.routes[s.OriDomain][w]);o.routes[s.OriDomain]=S,S.length>0&&M.push(s.OriDomain)}if(o.domains=M,S.length==0){var B={};for(var b in o.routes)b!=s.OriDomain&&(B[b]=o.routes[b]);o.routes=B}return o}}),a=_(!1),v=_(!1),p=_(!1),i=_(""),d=_(""),u=V(()=>i.value.length<6||p.value&&(!d.value||d.value.length==0));fe(()=>i.value,o=>{a.value=!1,v.value=!1,i.value=i.value.toLowerCase().replace(/[^\.:0-9a-f]/ig,"")}),fe(()=>d.value,o=>{d.value=d.value.replace(/[^\.:\/'\-_0-9a-zA-Z]/g,"")});const r=/((^\s*((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))\s*$)|(^\s*((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$))/;function c(){if(i.value==s.OriResolver&&(d.value==s.OriDomain&&p.value||s.OriDomain==""&&!p.value)&&n("close"),!r.test(i.value)){a.value=!0;return}var o={};if(!p.value&&s.OriDomain=="")if(o=s.currentDNS,!o.resolvers||o.resolvers.length==0){for(var f in o.fallbackResolvers)if(o.fallbackResolvers[f]==i.value){v.value=!0;return}for(var f in o.fallbackResolvers)if(o.fallbackResolvers[f]==s.OriResolver){o.fallbackResolvers[f]=i.value;break}}else{for(var f in o.resolvers)if(o.resolvers[f]==i.value){v.value=!0;return}for(var f in o.resolvers)if(o.resolvers[f]==s.OriResolver){o.resolvers[f]=i.value;break}}if(!p.value&&s.OriDomain!="")if(o=l.value,!s.currentDNS.resolvers||s.currentDNS.resolvers.length==0){for(var f in o.fallbackResolvers)if(o.fallbackResolvers[f]==i.value){v.value=!0;return}o.fallbackResolvers||(o.fallbackResolvers=[]),o.fallbackResolvers.push(i.value)}else{for(var f in o.resolvers)if(o.resolvers[f]==i.value){v.value=!0;return}o.resolvers||(o.resolvers=[]),o.resolvers.push(i.value)}if(p.value&&i.value!=s.OriResolver&&d.value==s.OriDomain){o=s.currentDNS;for(var g in o.routes[d.value])if(o.routes[d.value][g]==i.value){v.value=!0;return}for(var g in o.routes[d.value])if(o.routes[d.value][g]==s.OriResolver){o.routes[d.value][g]=i.value;break}}if(p.value&&d.value!=s.OriDomain){o=l.value;var P=!1;for(var f in o.domains)if(o.domains[f]==d.value){for(var g in o.routes[d.value])if(o.routes[d.value][g]==i.value){v.value=!0;return}o.routes[d.value]||(o.routes[d.value]=[]),o.routes[d.value].push(i.value),P=!0;break}P||(o.domains||(o.domains=[]),o.domains.push(d.value),o.routes[d.value]=[],o.routes[d.value].push(i.value))}axios.post("/admin/api/dns",o).then(function(M){M.data.status=="success"?n("nameserver-edited",M.data.data):console.log(M.data.status)}).catch(function(M){console.log(M)})}return xe(()=>{i.value=s.OriResolver,d.value=s.OriDomain,d.value!=""&&(p.value=!0)}),(o,f)=>(h(),m("div",{onClick:f[6]||(f[6]=J(g=>o.$emit("close"),["self"])),class:"fixed overflow-y-auto inset-0 py-8 z-30 bg-gray-900 bg-opacity-[0.07]",style:{"pointer-events":"auto"}},[e("div",tc,[sc,e("form",{onSubmit:f[4]||(f[4]=J(()=>{},["prevent"]))},[e("div",nc,[oc,ac,e("div",lc,[ae(e("input",{"onUpdate:modelValue":f[0]||(f[0]=g=>i.value=g),class:ne([{"border-stone-200":!a.value&&!v.value,"border-red-400":a.value||v.value},"w-full px-3 z-30 border focus:outline-blue-500/60 hover:border disabled:hover:border-stone-200 disabled:border-stone-200 hover:border-stone-400 rounded-md h-9 min-h-fit tabular-nums"]),id:"nameserver",type:"text",placeholder:"1.2.3.4",autocapitalize:"off",autocomplete:"off"},null,2),[[De,i.value]])]),a.value?(h(),m("p",ic,"不合法，只允许IPv4或IPv6地址")):$("",!0),v.value?(h(),m("p",rc,"该域名解析服务器条目已存在")):$("",!0)]),e("div",dc,[cc,e("span",uc,[ae(e("input",{"onUpdate:modelValue":f[1]||(f[1]=g=>p.value=g),id:"restrict",type:"checkbox",class:"toggle toggle-large mt-2 sm:mt-0 self-start shrink-0"},null,512),[[Te,p.value]])]),vc]),p.value?(h(),m("div",hc,[fc,e("div",mc,[ae(e("input",{"onUpdate:modelValue":f[2]||(f[2]=g=>d.value=g),class:"w-full px-3 z-30 border focus:outline-blue-500/60 hover:border disabled:hover:border-stone-200 disabled:border-stone-200 border-stone-200 hover:border-stone-400 rounded-md h-9 min-h-fit",id:"searchdomain",type:"text",placeholder:"example.com",autocapitalize:"off",autocomplete:"off"},null,512),[[De,d.value]])]),pc])):$("",!0),e("footer",bc,[e("button",{onClick:f[3]||(f[3]=g=>o.$emit("close")),class:"btn border border-base-300 hover:border-base-300 bg-base-200 hover:bg-base-300 text-black h-9 min-h-fit"},"取消"),e("button",{onClick:c,class:"btn border-0 bg-blue-500 hover:bg-blue-900 disabled:bg-blue-500/60 text-white disabled:text-white/60 h-9 min-h-fit",disabled:O(u)},"保存",8,gc)])],32),e("button",{onClick:f[5]||(f[5]=g=>o.$emit("close")),class:"btn btn-sm btn-ghost absolute top-5 right-5 px-2 py-2 border-0 bg-base-0 focus:bg-base-200 hover:bg-base-200",type:"button"},_c)])]))}},wc=Re(yc,[["__scopeId","data-v-b94cc905"]]);const ee=t=>(Pe("data-v-4bc1de45"),t=t(),je(),t),kc={class:"container mx-auto pb-20 md:pb-24"},$c={class:"mb-24"},Sc=ee(()=>e("header",{class:"mb-8"},[e("div",{class:"flex justify-between items-center"},[e("div",{class:"flex items-center"},[e("h1",{class:"text-3xl font-semibold tracking-tight leading-tight mb-2",tabindex:"-1"},"DNS")])])],-1)),Cc={class:"mb-16 max-w-2xl"},Nc=ee(()=>e("header",{class:"mb-6"},[e("h2",{class:"text-xl font-semibold tracking-tight mb-1"},"蜃境网域"),e("p",{class:"text-gray-600"},"这个名称用来注册DNS条目、分享设备给其他蜃境网域以及发放TLS证书")],-1)),Ec={class:"max-w-sm"},Rc={class:"flex border border-stone-200 hover:border-stone-400 rounded-md relative overflow-hidden min-w-0"},Pc=["value"],jc={class:"mb-16 max-w-2xl"},Mc=ee(()=>e("header",{class:"mb-6"},[e("h2",{class:"text-xl font-semibold tracking-tight mb-1"},"幻域"),e("p",{class:"text-gray-600"},"自动为您蜃境网域中的设备注册域名，令您从而可以使用名称替代IP地址访问设备")],-1)),Ic={class:"mb-16 max-w-2xl"},Bc=ee(()=>e("header",{class:"mb-6"},[e("h2",{class:"text-xl font-semibold tracking-tight mb-1"},"域名服务器"),e("p",{class:"text-gray-600"},"设置您网络中设备可用来解析DNS的域名服务器")],-1)),Dc={class:"text-gray-900"},Oc={key:0,class:"py-3"},Ac={class:"flex mb-1"},zc={class:"font-medium text-gray-600 mr-2 mb-1"},Lc=_e('<div class="space-x-2 mb-1" data-v-4bc1de45><div class="inline-flex items-center align-middle justify-center font-medium border border-gray-200 bg-gray-200 text-gray-600 rounded-sm px-1 text-xs relative -top-px" data-v-4bc1de45><svg width="0.9em" height="0.9em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="mr-1" data-v-4bc1de45><path d="M6.5 12.5L8.05719 15.9428L11.5 17.5L8.05719 19.0572L6.5 22.5L4.94281 19.0572L1.5 17.5L4.94281 15.9428L6.5 12.5Z" fill="currentColor" data-v-4bc1de45></path><path d="M15.5 1L17.8358 6.16421L23 8.5L17.8358 10.8358L15.5 16L13.1642 10.8358L8 8.5L13.1642 6.16421L15.5 1Z" fill="currentColor" data-v-4bc1de45></path></svg><span data-v-4bc1de45>幻域</span></div></div>',1),Tc={class:"border border-gray-200 bg-white rounded-md divide-y overflow-hidden"},Uc={class:"flex justify-between select-none"},Hc=ee(()=>e("div",{class:"pl-4 flex flex-1 items-start"},[e("div",{class:"tabular-nums pr-2 py-2 w-full"},"100.100.100.100")],-1)),Vc={class:"p-2 pr-4 flex items-center justify-center"},Gc={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"text-gray-400",style:{transform:"translateX(0.125rem) scale(0.75)"}},Kc=ee(()=>e("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"},null,-1)),qc=ee(()=>e("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"},null,-1)),Fc=[Kc,qc],Wc={"data-rbd-droppable-id":"search-domains","data-rbd-droppable-context-id":"0"},Qc={class:"DNSDomainGroup py-3 -mx-3 px-3 rounded-md","data-rbd-draggable-context-id":"0","data-rbd-draggable-id":"abc.com"},Zc={class:"flex items-center mb-1",tabindex:"0",role:"button","aria-describedby":"rbd-hidden-text-0-hidden-text-0","data-rbd-drag-handle-draggable-id":"abc.com","data-rbd-drag-handle-context-id":"0",draggable:"false"},Xc=_e('<div class="py-1 px-2 -ml-2" data-v-4bc1de45><svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" class="relative -top-px text-gray-400" data-v-4bc1de45><circle cx="12" cy="12" r="10" data-v-4bc1de45></circle><line x1="2" y1="12" x2="22" y2="12" data-v-4bc1de45></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" data-v-4bc1de45></path></svg></div>',1),Yc={class:"font-medium mb-1 mr-2 text-gray-600"},Jc=_e('<div class="space-x-2 mb-1" data-v-4bc1de45><span data-state="closed" data-v-4bc1de45><div class="inline-flex items-center align-middle justify-center font-medium border border-gray-200 bg-gray-200 text-gray-600 rounded-sm px-1 text-xs" data-v-4bc1de45><svg xmlns="http://www.w3.org/2000/svg" width="0.9em" height="0.9em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1" data-v-4bc1de45><polyline points="16 3 21 3 21 8" data-v-4bc1de45></polyline><line x1="4" y1="20" x2="21" y2="3" data-v-4bc1de45></line><polyline points="21 16 21 21 16 21" data-v-4bc1de45></polyline><line x1="15" y1="15" x2="21" y2="21" data-v-4bc1de45></line><line x1="4" y1="4" x2="9" y2="9" data-v-4bc1de45></line></svg>分离 DNS </div></span></div>',1),eu={class:"border border-gray-200 bg-white rounded-md divide-y overflow-hidden"},tu={class:"transition-shadow -mb-px flex justify-between select-none"},su={class:"pl-4 flex flex-1 items-start"},nu={class:"tabular-nums pr-2 py-2 w-full"},ou=ee(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round","aria-label":"Actions…",class:"text-gray-500"},[e("circle",{cx:"12",cy:"12",r:"1"}),e("circle",{cx:"19",cy:"12",r:"1"}),e("circle",{cx:"5",cy:"12",r:"1"})],-1)),au=[ou],lu={class:"pt-3"},iu={class:"flex items-center mb-2"},ru=ee(()=>e("h4",{class:"font-medium text-gray-600 mr-2"},"全球域名服务器",-1)),du={class:"flex items-center space-x-2 ml-auto"},cu=_e(`<label class="flex items-center cursor-pointer text-sm font-medium select-none space-x-1 text-gray-500" for="fallback" data-v-4bc1de45><span class="tooltip" data-tip="启用时，连接的客户端会忽略本地DNS设置，并总使用这些全球域名服务器。
禁用时，客户端首选本地DNS设置，只在需要时使用这些全球服务器。" data-v-4bc1de45><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="relative -top-0.5 inline-block" data-v-4bc1de45><circle cx="12" cy="12" r="10" data-v-4bc1de45></circle><line x1="12" y1="16" x2="12" y2="12" data-v-4bc1de45></line><line x1="12" y1="8" x2="12.01" y2="8" data-v-4bc1de45></line></svg></span><span data-v-4bc1de45>覆盖本地 DNS</span></label>`,1),uu=["disabled","checked"],vu={class:"border border-gray-200 bg-white rounded-md divide-y overflow-hidden"},hu={key:0,class:"-mb-px flex justify-between select-none"},fu=ee(()=>e("div",{class:"pl-4 flex flex-1 items-start text-gray-400"},[e("div",{class:"tabular-nums pr-2 py-2 w-full"},"本地 DNS 设置")],-1)),mu={class:"p-2 pr-4 flex items-center justify-center"},pu={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"text-gray-400",style:{transform:"translateX(0.125rem) scale(0.75)"}},bu=ee(()=>e("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"},null,-1)),gu=ee(()=>e("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"},null,-1)),xu=[bu,gu],_u={class:"transition-shadow -mb-px flex justify-between select-none"},yu={class:"pl-4 flex flex-1 items-start"},wu={class:"tabular-nums pr-2 py-2 w-full"},ku=ee(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round","aria-label":"Actions…",class:"text-gray-500"},[e("circle",{cx:"12",cy:"12",r:"1"}),e("circle",{cx:"19",cy:"12",r:"1"}),e("circle",{cx:"5",cy:"12",r:"1"})],-1)),$u=[ku],Su=ee(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.2","stroke-linecap":"round","stroke-linejoin":"round",class:"ml-2"},[e("polyline",{points:"6 9 12 15 18 9"})],-1)),Cu={key:0,class:"mb-16 max-w-2xl"},Nu=ee(()=>e("header",{class:"mb-6"},[e("h2",{class:"text-xl font-semibold tracking-tight mb-1"},[K("HTTPS 证书"),e("div",{class:"inline-flex items-center align-middle justify-center font-medium border border-yellow-50 bg-yellow-50 text-yellow-600 rounded-full px-2 py-1 leading-none relative text-sm ml-2 -top-px"}," Unavailable")]),e("p",{class:"text-gray-600"},"允许用户为他们的设备生辰HTTPS证书")],-1)),Eu={key:0,class:"btn border-0 bg-red-600 hover:bg-red-700 text-white h-9 min-h-fit"},Ru={class:"bg-white rounded-lg relative p-4 md:p-6 text-gray-700 max-w-lg min-w-[19rem] my-8 mx-auto w-[97%] shadow-2xl",style:{"pointer-events":"auto"}},Pu=ee(()=>e("header",{class:"flex items-center justify-between space-x-4 mb-5 mr-8"},[e("div",{class:"font-semibold text-lg truncate"},"停用幻域？")],-1)),ju=ee(()=>e("p",{class:"text-gray-700 mb-4"},"你网络中的用户将无法继续使用短名称在蜃境中访问设备",-1)),Mu={class:"flex mt-10 justify-end space-x-4"},Iu=ee(()=>e("button",{class:"btn border-0 bg-red-600 hover:bg-red-700 text-white h-9 min-h-fit",type:"submit"},"停用幻域",-1)),Bu=ee(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.25em",height:"1.25em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)),Du=[Bu],Ou={class:"dropdown bg-white rounded-md py-1 z-20"},Au={class:"dropdown bg-white rounded-md py-1 z-20"},zu=ee(()=>e("div",{class:"my-1 border-b border-base-300"},null,-1)),Lu={__name:"DNS",setup(t){const n=_("true"),s=_(!1),l=_("");fe(s,()=>{s.value&&setTimeout(function(){s.value=!1},5e3)});const a=_(!1),v=_(null),p=_(!1),i=_(0),d=_(0),u=_(!1);function r(){var y,C,k,W,q,ue,Ce,x;v.value!=null&&(i.value=(y=v.value)==null?void 0:y.getBoundingClientRect().left,((C=v.value)==null?void 0:C.getBoundingClientRect().top)>window.innerHeight-108?d.value=((k=v.value)==null?void 0:k.getBoundingClientRect().top)-58:d.value=((W=v.value)==null?void 0:W.getBoundingClientRect().top)+42),c.value!=null&&(o.value=((q=c.value)==null?void 0:q.getBoundingClientRect().left)-80,((ue=c.value)==null?void 0:ue.getBoundingClientRect().top)>window.innerHeight-112?f.value=((Ce=c.value)==null?void 0:Ce.getBoundingClientRect().top)-76:f.value=(x=c.value)==null?void 0:x.getBoundingClientRect().top)}const c=_(null),o=_(0),f=_(0),g=_(!1),P=_(!1),M=_(""),S=_(""),w=V(()=>{var y=JSON.parse(JSON.stringify(b.value));if(S.value==""){if(M.value=="")return y;if(!y.resolvers||y.resolvers.length==0){var C=[];for(var k in y.fallbackResolvers)y.fallbackResolvers[k]!=M.value&&C.push(y.fallbackResolvers[k]);return y.fallbackResolvers=C,y}else{var W=[];for(var k in y.resolvers)y.resolvers[k]!=M.value&&W.push(y.resolvers[k]);return y.resolvers=W,y}}else{if(M.value=="")return y;var q=[],ue=[];for(var k in y.domains)if(y.domains[k]!=S.value)q.push(y.domains[k]);else{for(var Ce in y.routes[S.value])y.routes[S.value][Ce]!=M.value&&ue.push(y.routes[S.value][Ce]);y.routes[S.value]=ue,ue.length>0&&q.push(S.value)}if(y.domains=q,ue.length==0){var x={};for(var j in y.routes)j!=S.value&&(x[j]=y.routes[j]);y.routes=x}return y}});function B(y){var C;for(c.value=y.target;((C=c.value)==null?void 0:C.tagName.toLowerCase())!="button";)c.value=c.value.parentNode;r(),ge(!0),M.value=c.value.parentNode.previousElementSibling.firstChild.innerText,c.value.parentNode.parentNode.parentNode.previousElementSibling.firstChild.innerText=="全球域名服务器"?S.value="":S.value=c.value.parentNode.parentNode.parentNode.previousElementSibling.firstChild.nextElementSibling.innerText,g.value=!0}const b=_({}),N=V(()=>b.value.magicDNSDomains[0]),U=V(()=>b.value.resolvers&&b.value.resolvers.length>0),X=V(()=>b.value.magicDNS),pe=V(()=>U.value?b.value.resolvers:b.value.fallbackResolvers),$e=V(()=>b.value.domains),Se=V(()=>b.value.routes),be=_("复制");function ce(){navigator.clipboard.writeText(N.value).then(function(){be.value="已复制!",setTimeout(()=>{be.value="复制"},3e3)})}xe(()=>{r(),window.addEventListener("resize",r),window.addEventListener("scroll",r),axios.get("/admin/api/dns").then(function(y){y.data.status=="success"?b.value=y.data.data:y.data.status.substring(6)=="用户信息核对失败"}).catch(function(y){alert(y)})});function ye(y){var C=b.value;switch(y){case"on":case"doOff":C.magicDNS=y=="on",axios.post("/admin/api/dns",C).then(function(k){k.data.status=="success"?(b.value=k.data.data,a.value=!1,ge(!1),l.value=y=="on"?"已启用幻域":"已禁用幻域",s.value=!0):console.log(k.data.status)}).catch(function(k){console.log(k)});break;case"off":ge(!0),a.value=!0;break}}function A(y){var C=b.value;y.target.checked?(C.resolvers=C.fallbackResolvers,C.fallbackResolvers=[]):(C.fallbackResolvers=C.resolvers,C.resolvers=[]),axios.post("/admin/api/dns",C).then(function(k){k.data.status=="success"?b.value=k.data.data:console.log(k.data.status)}).catch(function(k){console.log(k)})}function H(y){b.value=y,u.value=!1}function F(y){b.value=y,P.value=!1}function I(){axios.post("/admin/api/dns",w.value).then(function(y){y.data.status=="success"?b.value=y.data.data:console.log(y.data.status)}).catch(function(y){console.log(y)}).then(function(){S.value="",M.value="",g.value=!1,ge(!1)})}return(y,C)=>(h(),m(Y,null,[e("main",kc,[e("section",$c,[Sc,e("section",Cc,[Nc,e("div",Ec,[e("div",Rc,[e("input",{onclick:"this.select()",class:"outline-none py-2 px-3 w-full h-full font-mono text-sm text-ellipsis",readonly:"",value:O(N)},null,8,Pc),e("button",{onClick:ce,class:"flex justify-center py-2 pl-3 pr-4 rounded-md bg-white focus:outline-none font-sans text-blue-500 hover:text-blue-800 font-medium text-sm whitespace-nowrap"},E(be.value),1)])]),e("button",{disabled:"",onClick:C[0]||(C[0]=k=>y.$emit("")),class:"btn border border-stone-300 hover:border-stone-300 disabled:border-stone-300 bg-base-200 hover:bg-base-300 disabled:bg-base-200/60 text-black disabled:text-black/30 h-9 min-h-fit mt-8"},"网域重命名")]),e("section",jc,[Mc,O(X)?(h(),m("button",{key:0,onClick:C[1]||(C[1]=k=>ye("off")),class:"btn border-0 bg-red-600 hover:bg-red-700 text-white h-9 min-h-fit"},"停用幻域…")):$("",!0),O(X)?$("",!0):(h(),m("button",{key:1,onClick:C[2]||(C[2]=k=>ye("on")),class:"btn border-0 bg-blue-500 hover:bg-blue-900 text-white h-9 min-h-fit"},"启用幻域"))]),e("section",Ic,[Bc,e("div",Dc,[O(X)?(h(),m("div",Oc,[e("header",Ac,[e("h4",zc,E(O(N)),1),Lc]),e("div",Tc,[e("div",Uc,[Hc,e("div",Vc,[(h(),m("svg",Gc,Fc))])])])])):$("",!0),e("div",Wc,[(h(!0),m(Y,null,re(O($e),k=>(h(),m("div",Qc,[e("header",Zc,[Xc,e("h4",Yc,E(k),1),Jc]),e("div",eu,[(h(!0),m(Y,null,re(O(Se)[k],W=>(h(),m("div",tu,[e("div",su,[e("div",nu,E(W),1)]),e("div",{class:"pr-2 pt-1.5"},[e("button",{onClick:B,type:"button",id:"radix-:r19:","aria-haspopup":"menu","aria-expanded":"false","data-state":"closed",class:"py-0.5 px-2 shadow-none rounded-md border border-gray-300/0 group-hover:border-gray-300/100 hover:border-gray-300/100 group-hover:bg-white hover:!bg-gray-0 group-hover:shadow-md hover:shadow-md hover:cursor-pointer active:border-gray-300/100 active:shadow focus:outline-none focus:ring transition-shadow duration-100 ease-in-out z-50"},au)])]))),256))])]))),256))]),e("div",lu,[e("header",iu,[ru,e("div",du,[cu,e("input",{onChange:A,disabled:!O(pe)||O(pe).length==0,checked:O(U),id:"fallback",ref:"fallback",type:"checkbox",class:"toggle toggle-xs"},null,40,uu)])]),e("div",vu,[O(U)?$("",!0):(h(),m("div",hu,[fu,e("div",mu,[(h(),m("svg",pu,xu))])])),(h(!0),m(Y,null,re(O(pe),k=>(h(),m("div",_u,[e("div",yu,[e("div",wu,E(k),1)]),e("div",{class:"pr-2 pt-1.5"},[e("button",{onClick:B,type:"button",id:"radix-:r26:","aria-haspopup":"menu","aria-expanded":"false","data-state":"closed",class:"py-0.5 px-2 shadow-none rounded-md border border-gray-300/0 group-hover:border-gray-300/100 hover:border-gray-300/100 group-hover:bg-white hover:!bg-gray-0 group-hover:shadow-md hover:shadow-md hover:cursor-pointer active:border-gray-300/100 active:shadow focus:outline-none focus:ring transition-shadow duration-100 ease-in-out z-50"},$u)])]))),256))])])]),e("button",{ref_key:"addNSBtn",ref:v,onClick:C[3]||(C[3]=k=>{p.value=!0,O(ge)(!0)}),class:"btn border border-base-300 hover:border-base-300 bg-base-200 hover:bg-base-300 text-black h-9 min-h-fit mt-8"},[K(" 添加域名服务器 "),Su],512)]),n.value?$("",!0):(h(),m("section",Cu,[Nu,(h(),m("button",Eu,"停用HTTPS证书…")),$("",!0)]))])]),(h(),Z(he,{to:".toast-container"},[le(Ye,{show:s.value,msg:l.value,onClose:C[4]||(C[4]=k=>s.value=!1)},null,8,["show","msg"])])),(h(),Z(he,{to:"body"},[a.value?(h(),m("div",{key:0,onClick:C[8]||(C[8]=J(k=>{a.value=!1,O(ge)(!1)},["self"])),class:"fixed overflow-y-auto inset-0 py-8 z-30 bg-gray-900 bg-opacity-[0.07]",style:{"pointer-events":"auto"}},[e("div",Ru,[Pu,e("form",{onSubmit:C[6]||(C[6]=J(k=>ye("doOff"),["prevent"]))},[ju,e("footer",Mu,[e("button",{onClick:C[5]||(C[5]=k=>{a.value=!1,O(ge)(!1)}),class:"btn border border-base-300 hover:border-base-300 bg-base-200 hover:bg-base-300 text-black h-9 min-h-fit",type:"button"},"取消"),Iu])],32),e("button",{onClick:C[7]||(C[7]=k=>{a.value=!1,O(ge)(!1)}),class:"btn btn-sm btn-ghost absolute top-5 right-5 px-2 py-2 border-0 bg-base-0 focus:bg-base-200 hover:bg-base-200",type:"button"},Du)])])):$("",!0),p.value?(h(),m("div",{key:1,onClick:C[10]||(C[10]=J(k=>{p.value=!1,O(ge)(!1)},["self"])),class:"fixed overflow-y-auto inset-0 py-8 z-30 bg-opacity-0",style:{"pointer-events":"auto"}},[e("div",{class:"fixed min-w-max shadow-lg border border-stone-200 rounded-md z-20",style:Ze("left: "+i.value+"px; top: "+d.value+"px;")},[e("div",Ou,[e("div",{onClick:C[9]||(C[9]=k=>{u.value=!0,p.value=!1}),class:"block w-40 px-4 py-2 cursor-pointer hover:bg-stone-100 focus:outline-none focus:bg-stone-100"}," 自定义…")])],4)])):$("",!0),g.value?(h(),m("div",{key:2,onClick:C[12]||(C[12]=J(k=>{g.value=!1,O(ge)(!1)},["self"])),class:"fixed overflow-y-auto inset-0 py-8 z-30 bg-opacity-0",style:{"pointer-events":"auto"}},[e("div",{class:"fixed min-w-max shadow-lg border border-stone-200 rounded-md z-20",style:Ze("left: "+o.value+"px; top: "+f.value+"px;")},[e("div",Au,[e("div",{onClick:C[11]||(C[11]=k=>{P.value=!0,g.value=!1}),class:"block px-4 py-2 cursor-pointer hover:bg-stone-100 focus:outline-none focus:bg-stone-100"}," 编辑…"),zu,e("div",{onClick:I,class:"block px-4 py-2 cursor-pointer hover:bg-stone-100 focus:outline-none focus:bg-stone-100 text-red-400"}," 删除")])],4)])):$("",!0),u.value?(h(),Z(ec,{key:3,currentDNS:b.value,onNameserverAdded:H,onClose:C[13]||(C[13]=k=>u.value=!1)},null,8,["currentDNS"])):$("",!0),P.value?(h(),Z(wc,{key:4,currentDNS:b.value,OriDomain:S.value,OriResolver:M.value,onNameserverEdited:F,onClose:C[14]||(C[14]=k=>P.value=!1)},null,8,["currentDNS","OriDomain","OriResolver"])):$("",!0)]))],64))}},Tu=Re(Lu,[["__scopeId","data-v-4bc1de45"]]),Uu={class:"flex-1"},Hu=e("div",{class:"text-3xl font-semibold tracking-tight leading-tight mb-2 flex items-center"},[e("h1",{class:"mr-2",tabindex:"-1"},"通用")],-1),Vu=e("div",{class:"text-gray-600 mt-3 mb-10"},[e("p",null,"管理您的蜃境网络配置")],-1),Gu={class:"mt-10"},Ku={class:"space-y-10"},qu=e("header",{class:"max-w-2xl"},[e("h3",{class:"text-xl font-semibold tracking-tight"},"机构"),e("p",{class:"mt-1 text-gray-600"}," 这是您所属机构名称（个人用户显示您的账户），无法修改！ ")],-1),Fu={class:"mt-4"},Wu={class:"max-w-sm"},Qu={class:"flex border border-stone-200 hover:border-stone-400 rounded-md relative overflow-hidden min-w-0"},Zu=["value"],Xu=e("header",{class:"max-w-2xl"},[e("h3",{class:"text-xl font-semibold tracking-tight"},"密钥过期"),e("p",{class:"mt-1 text-gray-600"}," 设置设备可以保持登录蜃境网络而不需重新登录认证的天数 ")],-1),Yu={class:"mt-4"},Ju={class:"flex"},e0={class:"relative"},t0={class:"bg-white top-1 bottom-1 right-1 rounded-r-md absolute flex items-center"},s0={class:"flex items-center"},n0=["disabled"],o0=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1),a0=[o0],l0=["disabled"],i0=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1),r0=[i0],d0=e("div",{class:"flex items-center px-3 bg-gray-50 text-gray-500 border rounded-r border-l-0 border-gray-300"}," 天 ",-1),c0=e("p",{class:"text-sm text-gray-500 mt-1"},"请设置为1~180天",-1),u0={class:"mt-4"},v0=["disabled"],h0=["disabled"],f0={class:"mt-8"},m0=e("header",{class:"max-w-2xl"},[e("h3",{class:"text-xl font-semibold tracking-tight"},"注销蜃境"),e("p",{class:"mt-1 text-gray-600"}," 永久注销蜃境网络（删除所有设备及用户信息），无法恢复！ ")],-1),p0={class:"mt-4"},b0=["disabled"],Ke={__name:"General",setup(t){const n=_(!0),s=_(!1),l=_("");fe(s,()=>{s.value&&setTimeout(function(){s.value=!1},5e3)});const a=_(""),v=_(""),p=_(""),i=_(""),d=_(""),u=_(180),r=_(180),c=_(!1),o=_(!1),f=_(!1),g=_("复制");function P(){navigator.clipboard.writeText(d.value).then(function(){g.value="已复制!",setTimeout(()=>{g.value="复制"},3e3)})}function M(){Number(r.value)>1?c.value=!1:c.value=!0,Number(r.value)<180?o.value=!1:o.value=!0,Number(r.value)!=u.value?f.value=!1:f.value=!0}function S(N){r.value=r.value.replace(/[^\d]+/g,"").replace(/^0+(\d)/,"$1"),N&&(r.value==""&&(r.value=u.value),Number(r.value)==0&&(r.value=1),Number(r.value)>180&&(r.value=180)),M()}function w(N){N==!0?r.value=Number(r.value)+1:r.value=Number(r.value)-1,M()}function B(){r.value=u.value,M()}xe(()=>{axios.get("/admin/api/self").then(function(N){(N.data.errormsg==null||N.data.errormsg==="")&&(a.value=N.data.useraccount,v.value=N.data.basedomain,p.value=N.data.username,i.value=N.data.usernamehead,d.value=N.data.orgname)}).catch(function(N){alert(N)}).then(function(){}),axios.get("/admin/api/netsettings").then(function(N){N.data.status=="success"?(u.value=N.data.data.maxKeyDurationDays,r.value=N.data.data.maxKeyDurationDays,M()):N.data.status.substring(6)=="用户信息核对失败"}).catch(function(N){alert(N)}).then(function(){})});function b(){axios.post("/admin/api/netsetting/updatekeyexpiry",{maxKeyDurationDays:Number(r.value)}).then(function(N){N.data.status=="success"?(u.value=N.data.data,M(),l.value="已更新您网络中节点密钥最长有效期！",s.value=!0):(l.value="失败："+N.data.status.substring(6),s.value=!0)}).catch(function(N){console.log(N)})}return(N,U)=>(h(),m(Y,null,[e("div",Uu,[Hu,Vu,e("div",Gu,[e("div",Ku,[e("div",null,[qu,e("div",Fu,[e("div",Wu,[e("div",Qu,[e("input",{onclick:"this.select()",class:"outline-none py-2 px-3 w-full h-full font-mono text-sm text-ellipsis",readonly:"",value:d.value},null,8,Zu),e("button",{onClick:P,class:"flex justify-center py-2 pl-3 pr-4 rounded-md bg-white focus:outline-none font-sans text-blue-500 hover:text-blue-800 font-medium text-sm whitespace-nowrap"},E(g.value),1)])])])]),e("div",null,[Xu,e("div",Yu,[e("div",Ju,[e("div",e0,[ae(e("input",{"onUpdate:modelValue":U[0]||(U[0]=X=>r.value=X),onInput:U[1]||(U[1]=X=>S(!1)),onBlur:U[2]||(U[2]=X=>S(!0)),class:"input z-0 border focus:outline-blue-500/60 hover:border border-stone-200 hover:border-stone-400 rounded-r-none h-9 min-h-fit",inputmode:"numeric",pattern:"[0-9]*",id:"key-expiry-duration",tabindex:"0"},null,544),[[De,r.value]]),e("div",t0,[e("div",s0,[e("button",{onClick:U[3]||(U[3]=X=>w(!1)),class:"btn btn-ghost btn-sm px-2 hover:bg-stone-100 disabled:bg-transparent",disabled:c.value,type:"button",tabindex:"-1"},a0,8,n0),e("button",{onClick:U[4]||(U[4]=X=>w(!0)),class:"btn btn-ghost btn-sm px-2 hover:bg-stone-100 disabled:bg-transparent",disabled:o.value,type:"button",tabindex:"-1"},r0,8,l0)])])]),d0]),c0,e("div",u0,[e("button",{onClick:b,class:"btn border-0 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-600/60 text-white disabled:text-white/60 h-9 min-h-fit",disabled:f.value}," 保存 ",8,v0),e("button",{onClick:B,class:"btn border border-stone-300 hover:border-stone-300 disabled:border-stone-300 bg-base-200 hover:bg-base-300 disabled:bg-base-200/60 text-black disabled:text-black/30 h-9 min-h-fit ml-3",disabled:f.value}," 重置 ",8,h0)])])])]),e("div",f0,[m0,e("div",p0,[e("button",{disabled:n.value,class:"btn border-0 bg-red-600 hover:bg-red-700 disabled:bg-red-600/60 disabled:text-white/60 text-white h-9 min-h-fit"}," 注销蜃境… ",8,b0)])])])]),(h(),Z(he,{to:".toast-container"},[le(Ye,{show:s.value,msg:l.value,onClose:U[5]||(U[5]=X=>s.value=!1)},null,8,["show","msg"])]))],64))}};const oe=t=>(Pe("data-v-1a677560"),t=t(),je(),t),g0={class:"bg-white rounded-lg relative p-4 md:p-6 text-gray-700 max-w-lg min-w-[19rem] my-8 mx-auto w-[97%] shadow-2xl",tabindex:"-1",style:{"pointer-events":"auto"}},x0=oe(()=>e("header",{class:"flex items-center justify-between space-x-4 mb-5 mr-8"},[e("div",{class:"font-semibold text-lg truncate"},"生成授权密钥")],-1)),_0=["onSubmit"],y0={class:"flex justify-between"},w0=oe(()=>e("div",null,[e("h4",{class:"font-medium mb-1"},"可重用"),e("p",{class:"text-sm text-gray-500"},"使用此密钥授权多个设备")],-1)),k0={class:"ml-6"},$0=["disabled"],S0={class:"mt-4"},C0=oe(()=>e("h4",{class:"font-medium mb-1"},"过期",-1)),N0=oe(()=>e("p",{class:"text-sm text-gray-500"},"该授权密钥有效期天数。这个并不会影响使用该密钥授权的设备自身的设备密钥有效期限",-1)),E0={class:"flex mt-4"},R0={class:"relative"},P0=["disabled"],j0={class:"bg-white top-1 bottom-1 right-1 rounded-r-md absolute flex items-center"},M0={class:"flex items-center"},I0=["disabled"],B0=oe(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1)),D0=[B0],O0=["disabled"],A0=oe(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1)),z0=[A0],L0=oe(()=>e("div",{class:"flex items-center px-3 bg-gray-50 text-gray-500 border rounded-r border-l-0 border-gray-300"}," 天 ",-1)),T0=oe(()=>e("p",{class:"text-sm text-gray-500 mt-1"},"必须是1-90天",-1)),U0=oe(()=>e("div",{class:"border-t font-medium text-sm text-gray-500 tracking-wider uppercase mt-6 mb-1 pt-6"},"设备设置 ",-1)),H0=oe(()=>e("p",{class:"text-sm text-gray-500 mb-4"},"这些设置将应用于使用该密钥授权的所有设备",-1)),V0={class:"flex justify-between"},G0=oe(()=>e("div",null,[e("h4",{class:"font-medium mb-1"},"自熄"),e("p",{class:"text-sm text-gray-500"},"使用此密钥授权的设备会在离线时被自动从蜃境网络删除")],-1)),K0={class:"ml-6"},q0=["disabled"],F0={class:"flex justify-between mt-4"},W0=oe(()=>e("div",null,[e("h4",{class:"font-medium mb-1"},"标签"),e("p",{class:"text-sm text-gray-500"},"使用该密钥授权的设备会自动添加标签。这同时会使该设备自身密钥过期被禁用 ")],-1)),Q0={class:"ml-6"},Z0=["disabled"],X0={key:0,class:"rounded-md border border-stone-200 mt-4 mb-3 bg-stone-50 p-6"},Y0=oe(()=>e("div",{class:"flex justify-center"},[e("div",{class:"w-full text-center max-w-xl text-gray-500"},"未分配标签")],-1)),J0=[Y0],ev={key:1},tv=oe(()=>e("button",{class:"btn border border-stone-300 hover:border-stone-300 disabled:border-stone-300 bg-base-200 hover:bg-base-300 disabled:bg-base-200/60 text-black disabled:text-black/30 h-9 min-h-fit",disabled:"",type:"button"},[K("添加标签"),e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"ml-1"},[e("polyline",{points:"6 9 12 15 18 9"})])],-1)),sv=[tv],nv={class:"flex mt-10 justify-end space-x-4"},ov=oe(()=>e("button",{type:"submit",class:"btn border-0 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-600/60 text-white disabled:text-white/60 h-9 min-h-fit"},"生成密钥",-1)),av=["onSubmit"],lv=oe(()=>e("p",{class:"text-gray-700 mb-3"},"关闭前请确保您已复制下面新生成的密钥，它之后将不会再次完整展示",-1)),iv={class:"flex border border-stone-200 hover:border-stone-400 rounded-md relative overflow-hidden min-w-0 mb-3 font-mono text-sm"},rv=["value"],dv={type:"submit",class:"flex justify-center py-2 pl-3 pr-4 rounded-md bg-white focus:outline-none font-sans text-blue-500 hover:text-blue-800 font-medium text-sm whitespace-nowrap"},cv={class:"flex overflow-hidden rounded-md py-3 px-4 gap-2 text-sm bg-stone-50 text-gray-600 border border-stone-200",role:"alert"},uv=_e('<div class="pt-px" data-v-1a677560><svg xmlns="http://www.w3.org/2000/svg" width="1.125em" height="1.125em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-1a677560><circle cx="12" cy="12" r="10" data-v-1a677560></circle><line x1="12" y1="16" x2="12" y2="12" data-v-1a677560></line><line x1="12" y1="8" x2="12.01" y2="8" data-v-1a677560></line></svg></div>',1),vv={class:"w-full"},hv={class:"flex mt-10 justify-end space-x-4"},fv=oe(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.25em",height:"1.25em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)),mv=[fv],pv={__name:"GenAuthKey",emits:["added-authkey"],setup(t,{emit:n}){Me();const s=_(!1),l=_(!1),a=_(!1),v=_(!1),p=_(!1),i=_(90),d=_(!1),u=_(!0);function r(){Number(i.value)>1?d.value=!1:d.value=!0,Number(i.value)<90?u.value=!1:u.value=!0}function c(S){i.value=i.value.replace(/[^\d]+/g,"").replace(/^0+(\d)/,"$1"),S&&(i.value==""&&(i.value=1),Number(i.value)==0&&(i.value=1),Number(i.value)>90&&(i.value=90)),r()}function o(S){S==!0?i.value=Number(i.value)+1:i.value=Number(i.value)-1,r()}function f(){l.value=!0,axios.post("/admin/api/keys",{keyData:{type:"authkey",expirySeconds:Number(i.value*24*3600),authkey:{ephemeral:p.value,reusable:v.value,preauthorized:!1}}}).then(function(S){S.data.status=="success"?(P.value=S.data.data,n("added-authkey"),s.value=!0):console.log(S.data.status)}).catch(function(S){console.log(S)}).then(function(){l.value=!1})}const g=_("复制"),P=_({});function M(){navigator.clipboard.writeText(P.value.fullKey).then(function(){g.value="已复制!",setTimeout(()=>{g.value="复制"},3e3)})}return(S,w)=>(h(),m("div",{onClick:w[11]||(w[11]=J(B=>S.$emit("close"),["self"])),class:"fixed overflow-y-auto inset-0 py-8 z-30 bg-gray-900 bg-opacity-[0.07]",style:{"pointer-events":"auto"}},[e("div",g0,[x0,s.value?$("",!0):(h(),m("form",{key:0,onSubmit:J(f,["prevent"])},[e("div",y0,[w0,e("div",k0,[ae(e("input",{disabled:l.value,"onUpdate:modelValue":w[0]||(w[0]=B=>v.value=B),type:"checkbox",class:"toggle"},null,8,$0),[[Te,v.value]])])]),e("div",S0,[C0,N0,e("div",E0,[e("div",R0,[ae(e("input",{disabled:l.value,"onUpdate:modelValue":w[1]||(w[1]=B=>i.value=B),onInput:w[2]||(w[2]=B=>c(!1)),onBlur:w[3]||(w[3]=B=>c(!0)),class:"input z-30 border focus:outline-blue-500/60 hover:border border-stone-200 hover:border-stone-400 rounded-r-none h-9 min-h-fit",inputmode:"numeric",pattern:"[0-9]*",id:"key-expiry-duration",tabindex:"0"},null,40,P0),[[De,i.value]]),e("div",j0,[e("div",M0,[e("button",{onClick:w[4]||(w[4]=B=>o(!1)),class:"btn btn-ghost btn-sm px-2 hover:bg-stone-100 disabled:bg-transparent",disabled:d.value,type:"button",tabindex:"-1"},D0,8,I0),e("button",{onClick:w[5]||(w[5]=B=>o(!0)),class:"btn btn-ghost btn-sm px-2 hover:bg-stone-100 disabled:bg-transparent",disabled:u.value,type:"button",tabindex:"-1"},z0,8,O0)])])]),L0]),T0]),U0,H0,e("div",V0,[G0,e("div",K0,[ae(e("input",{disabled:l.value,"onUpdate:modelValue":w[6]||(w[6]=B=>p.value=B),type:"checkbox",class:"toggle"},null,8,q0),[[Te,p.value]])])]),e("div",F0,[W0,e("div",Q0,[ae(e("input",{disabled:l.value,"onUpdate:modelValue":w[7]||(w[7]=B=>a.value=B),type:"checkbox",class:"toggle"},null,8,Z0),[[Te,a.value]])])]),a.value?(h(),m("div",X0,J0)):$("",!0),a.value?(h(),m("span",ev,sv)):$("",!0),e("footer",nv,[e("button",{onClick:w[8]||(w[8]=J(B=>S.$emit("close"),["self"])),class:"btn border border-stone-300 hover:border-stone-300 disabled:border-stone-300 bg-base-200 hover:bg-base-300 disabled:bg-base-200/60 text-black disabled:text-black/30 h-9 min-h-fit"},"取消"),ov])],40,_0)),s.value?(h(),m("form",{key:1,onSubmit:J(M,["prevent"])},[lv,e("div",iv,[e("input",{onclick:"this.select()",class:"outline-none py-2 px-3 w-full h-full font-mono text-sm text-ellipsis",readonly:"",value:P.value.fullKey},null,8,rv),e("button",dv,E(g.value),1)]),e("div",cv,[uv,e("div",vv,"该密钥将在 "+E(P.value.expiry.split(" ")[0])+" 过期，之后您要想继续使用授权密钥需要重新生成",1)]),e("footer",hv,[e("button",{onClick:w[9]||(w[9]=J(B=>S.$emit("close"),["self"])),class:"btn border border-stone-300 hover:border-stone-300 disabled:border-stone-300 bg-base-200 hover:bg-base-300 disabled:bg-base-200/60 text-black disabled:text-black/30 h-9 min-h-fit"},"完成")])],40,av)):$("",!0),e("button",{onClick:w[10]||(w[10]=B=>S.$emit("close")),class:"btn btn-sm btn-ghost absolute top-5 right-5 px-2 py-2 border-0 bg-base-0 focus:bg-base-200 hover:bg-base-200",type:"button"},mv)])]))}},bv=Re(pv,[["__scopeId","data-v-1a677560"]]),gv={class:"flex-1"},xv=_e('<div class="text-3xl font-semibold tracking-tight leading-tight mb-2 flex items-center"><h1 class="mr-2" tabindex="-1">密钥管理</h1></div><div class="text-gray-600 mt-3 mb-10"><p>查看和管理您的<strong>授权密钥</strong>和<strong>API密钥</strong></p><p class="mt-2">您个人设备的私钥<strong>不</strong>在此管理，它们永远是<strong>私有</strong>并存在于您的设备上，<strong>不</strong>向蜃境披露</p></div>',2),_v={class:"mt-10"},yv=e("div",null,[e("h3",{class:"text-xl font-semibold tracking-tight"},"授权密钥"),e("p",{class:"text-gray-600"},"用于无需交互式登录即可实现设备鉴别接入 ")],-1),wv={key:0,class:"rounded-md border border-stone-200 mt-4 bg-stone-50 p-6"},kv=e("div",{class:"flex justify-center"},[e("div",{class:"w-full text-center max-w-xl text-gray-500"},"你还没有任何密钥")],-1),$v=[kv],Sv={key:1,class:"block border box-border rounded-lg mt-4 tb"},Cv=e("thead",{class:"block font-semibold tracking-wider text-left text-xs text-stone-500"},[e("tr",{class:"flex border-b border-stone-200 pl-8 pr-4 lg:px-4"},[e("th",{class:"w-36 shrink-0 py-2"},"ID"),e("th",{class:"hidden shrink-0 py-2 lg:block w-40"},"创建日期"),e("th",{class:"hidden shrink-0 py-2 lg:block w-40"},"失效日期"),e("th",{class:"flex-1 shrink-0 py-2 min-w-0"},"类型"),e("th",{class:"w-20 shrink-0 py-2 text-right text-red-400 cursor-pointer pointer-events-auto hover:text-red-600"},[e("span",{class:"sr-only"},"注销密钥")])])],-1),Nv={class:"block"},Ev=["onClick"],Rv={class:"flex shrink-0 py-2 w-36"},Pv={class:"w-8 -ml-8 lg:hidden"},jv={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round",class:"text-gray-400 w-4 mx-2 group-hover:text-gray-500"},Mv=["points"],Iv={class:"text-sm truncate leading-6 font-semibold"},Bv={class:"hidden shrink-0 py-2 lg:block w-40"},Dv={"data-state":"closed"},Ov={class:"cursor-default"},Av={class:"hidden shrink-0 py-2 lg:block w-40"},zv={"data-state":"closed"},Lv={class:"cursor-default"},Tv={class:"flex-1 shrink-0 py-2 min-w-0"},Uv={class:"w-20 shrink-0 py-2 text-right text-red-400 cursor-pointer pointer-events-auto hover:text-red-600"},Hv=["onClick"],Vv={key:0,class:"border-b-0 flex border-stone-200"},Gv={class:"shrink-0 p-0"},Kv={class:"flex-col px-8 pt-0.5 pb-2 lg:hidden"},qv={class:"flex items-center lg:hidden"},Fv=e("p",{class:"w-20 text-sm text-gray-500"},"创建日期",-1),Wv={class:"text-sm"},Qv={"data-state":"closed"},Zv={class:"cursor-default"},Xv={class:"flex items-center lg:hidden"},Yv=e("p",{class:"w-20 text-sm text-gray-500"},"失效日期",-1),Jv={class:"text-sm"},eh={"data-state":"closed"},th={class:"cursor-default"},sh={class:"flex justify-between items-center mt-16"},nh=e("div",null,[e("h3",{class:"text-xl font-semibold tracking-tight"},"API 密钥"),e("p",{class:"text-gray-600"},"API 密钥用于访问蜃境API.")],-1),oh=["disabled"],ah=e("div",{class:"rounded-md border border-stone-200 mt-4 bg-stone-50 p-6"},[e("div",{class:"flex justify-center"},[e("div",{class:"w-full text-center max-w-xl text-gray-500"},"你还没有任何密钥")])],-1),lh={class:"bg-white rounded-lg relative p-4 md:p-6 text-gray-700 max-w-lg min-w-[19rem] my-8 mx-auto w-[97%] shadow-2xl",style:{"pointer-events":"auto"}},ih=e("header",{class:"flex items-center justify-between space-x-4 mb-5 mr-8"},[e("div",{class:"font-semibold text-lg truncate"},"注销")],-1),rh=["onSubmit"],dh=e("p",{class:"text-gray-700 mb-4"},[K("注销此密钥"),e("strong",null,"并不会"),K("注销已使用此密钥进行授权的设备，但将阻止之后继续使用此密钥注册新设备。")],-1),ch={class:"flex mt-10 justify-end space-x-4"},uh=e("button",{class:"btn border-0 bg-red-600 hover:bg-red-700 text-white h-9 min-h-fit",type:"submit"},"注销密钥",-1),vh=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.25em",height:"1.25em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1),hh=[vh],fh={__name:"Keys",setup(t){const n=_(!0),s=_(!1);function l(){s.value=!0}const a=_([]);function v(){axios.get("/admin/api/keys").then(function(r){r.data.status=="success"&&(a.value=r.data.data.authKeys)}).catch(function(r){console.log(r)})}xe(()=>{axios.get("/admin/api/keys").then(function(r){r.data.status=="success"&&(a.value=r.data.data.authKeys)}).catch(function(r){console.log(r)})});const p=_(""),i=_(!1);function d(r){p.value=r,i.value=!0}function u(){axios.delete("/admin/api/keys/"+p.value,{}).then(function(r){if(r.data.status=="success"){var c=[];for(var o in a.value)a.value[o].id!=r.data.data&&c.push(a.value[o]);a.value=c,i.value=!1}else console.log(r.data.status)}).catch(function(r){console.log(r)})}return(r,c)=>(h(),m(Y,null,[e("div",gv,[xv,e("div",_v,[e("div",{class:"flex justify-between items-center mt-16"},[yv,e("button",{onClick:l,class:"btn border border-stone-300 hover:border-stone-300 disabled:border-stone-300 bg-base-200 hover:bg-base-300 disabled:bg-base-200/60 text-black disabled:text-black/30 h-9 min-h-fit ml-3 font-normal"}," 生成授权密钥…")]),!a.value||a.value.length==0?(h(),m("div",wv,$v)):$("",!0),a.value&&a.value.length>0?(h(),m("table",Sv,[Cv,e("tbody",Nv,[(h(!0),m(Y,null,re(a.value,(o,f)=>(h(),m(Y,null,[e("tr",{onClick:g=>o.expand=!o.expand,class:ne([{"border-t":f>0},"group flex border-stone-200 cursor-pointer hover:bg-gray-50 pl-8 pr-4 lg:px-4 lg:cursor-auto border-b-0"])},[e("td",Rv,[e("div",Pv,[(h(),m("svg",jv,[e("polyline",{points:o.expand?"6 9 12 15 18 9":"9 18 15 12 9 6"},null,8,Mv)]))]),e("pre",Iv,[e("code",null,E(o.id),1)])]),e("td",Bv,[e("span",Dv,[e("span",Ov,E(o.created.split(" ")[0]),1)])]),e("td",Av,[e("span",zv,[e("span",Lv,E(o.expiry.split(" ")[0]),1)])]),e("td",Tv,E((o.authkey.reusable==!0?"可重用":"一次性")+(o.authkey.ephemeral==!0?",自熄":"")),1),e("td",Uv,[e("button",{onClick:g=>d(o.id),type:"button"},"注销…",8,Hv)])],10,Ev),o.expand?(h(),m("tr",Vv,[e("td",Gv,[e("div",Kv,[e("div",qv,[Fv,e("p",Wv,[e("span",Qv,[e("span",Zv,E(o.created.split(" ")[0]),1)])])]),e("div",Xv,[Yv,e("p",Jv,[e("span",eh,[e("span",th,E(o.expiry.split(" ")[0]),1)])])])])])])):$("",!0)],64))),256))])])):$("",!0),e("div",sh,[nh,e("button",{disabled:n.value,class:"btn border border-stone-300 hover:border-stone-300 disabled:border-stone-300 bg-base-200 hover:bg-base-300 disabled:bg-base-200/60 text-black disabled:text-black/30 h-9 min-h-fit ml-3 font-normal"}," 生成 API 密钥…",8,oh)]),ah])]),(h(),Z(he,{to:"body"},[s.value?(h(),Z(bv,{key:0,onAddedAuthkey:v,onClose:c[0]||(c[0]=o=>s.value=!1)})):$("",!0),i.value?(h(),m("div",{key:1,onClick:c[3]||(c[3]=J(o=>i.value=!1,["self"])),class:"fixed overflow-y-auto inset-0 py-8 z-30 bg-gray-900 bg-opacity-[0.07]",style:{"pointer-events":"auto"}},[e("div",lh,[ih,e("form",{onSubmit:J(u,["prevent"])},[dh,e("footer",ch,[e("button",{onClick:c[1]||(c[1]=o=>i.value=!1),class:"btn border border-base-300 hover:border-base-300 bg-base-200 hover:bg-base-300 text-black h-9 min-h-fit",type:"button"},"取消"),uh])],40,rh),e("button",{onClick:c[2]||(c[2]=o=>i.value=!1),class:"btn btn-sm btn-ghost absolute top-5 right-5 px-2 py-2 border-0 bg-base-0 focus:bg-base-200 hover:bg-base-200",type:"button"},hh)])])):$("",!0)]))],64))}},mh={class:"container mx-auto pb-20 md:pb-24"},ph={class:"md:flex md:mt-16"},bh={class:"mb-10 md:mr-20 lg:mr-40"},gh={class:"hidden md:block"},xh={class:"flex flex-row mb-12"},_h=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"text-gray-500"},[e("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e("polyline",{points:"9 22 9 12 15 12 15 22"})],-1),yh={class:"ml-4"},wh=e("h2",{class:"text-gray-500 font-medium"},"网络配置",-1),kh={class:"flex flex-row mb-12"},$h=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"text-gray-500"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1),Sh={class:"ml-4"},Ch=e("h2",{class:"text-gray-500 font-medium"},"个人设置",-1),Nh={class:"select-with-arrow md:hidden mb-4"},Eh=_e('<optgroup label="网络配置"><option value="features">敬请期待</option><option value="general">通用</option><option value="webhooks">敬请期待</option><option value="billing">敬请期待</option><option value="contact-preferences">敬请期待</option></optgroup><optgroup label="个人设置"><option value="keys">密钥管理</option></optgroup>',2),Rh=[Eh],Ph={__name:"Settings",setup(t){const n={general:Ke,features:Ke,webhooks:Ke,billing:Ke,"contact-preferences":Ke,keys:fh},s=ft(),l=ht(),a=_("");function v(p){l.push("/settings/"+p.target.value)}return Js((p,i)=>{a.value=p.params.setpart}),xe(()=>{a.value=s.params.setpart}),(p,i)=>{const d=We("router-link");return h(),m("main",mh,[e("section",ph,[e("div",bh,[e("div",gh,[e("div",xh,[_h,e("div",yh,[wh,le(d,{class:ne(["flex font-medium mt-4",{"text-blue-600":a.value=="general","text-gray-700":a.value!="general"}]),to:"/settings/general"},{default:ve(()=>[K("通用")]),_:1},8,["class"]),le(d,{class:ne(["flex font-medium mt-4",{"text-blue-600":a.value=="features","text-gray-700":a.value!="features"}]),to:"/settings/features"},{default:ve(()=>[K("敬请期待")]),_:1},8,["class"]),le(d,{class:ne(["flex font-medium mt-4",{"text-blue-600":a.value=="webhooks","text-gray-700":a.value!="webhooks"}]),to:"/settings/webhooks"},{default:ve(()=>[K("敬请期待")]),_:1},8,["class"]),le(d,{class:ne(["flex font-medium mt-4",{"text-blue-600":a.value=="billing","text-gray-700":a.value!="billing"}]),to:"/settings/billing"},{default:ve(()=>[K("敬请期待")]),_:1},8,["class"]),le(d,{class:ne(["flex font-medium mt-4",{"text-blue-600":a.value=="contact-preferences","text-gray-700":a.value!="contact-preferences"}]),to:"/settings/contact-preferences"},{default:ve(()=>[K("敬请期待")]),_:1},8,["class"])])]),e("div",kh,[$h,e("div",Sh,[Ch,le(d,{class:ne(["flex font-medium mt-4",{"text-blue-600":a.value=="keys","text-gray-700":a.value!="keys"}]),to:"/settings/keys"},{default:ve(()=>[K("密钥管理")]),_:1},8,["class"])])])]),e("div",Nh,[ae(e("select",{"onUpdate:modelValue":i[0]||(i[0]=u=>a.value=u),onChange:v,class:"select select-bordered w-full text-lg"},Rh,544),[[es,a.value,void 0,{lazy:!0}]])])]),(h(),Z(ts(n[a.value])))])])}}},jh=[{path:"/",redirect:"/machines"},{path:"/machines",component:Sl},{path:"/machines/:mip",component:Md},{path:"/dns",component:Tu},{path:"/settings",redirect:"/settings/general"},{path:"/settings/:setpart",component:Ph}],Mh=rn({history:ws(),routes:jh}),st=ss(eo);st.config.errorHandler=t=>{};st.use(ns);st.use(Mh);st.mount("#app");
